--exec Proc_FillDropDown @option=N'TMForBOCanvas',@option1=N'6030',@option2=N'2',@option3=N''                    
--exec [proc_Report_FillDropdown] 'PG','Campaign','2365','34757','1',2,'',1137                    
--exec [proc_FillDropdown] 'Campaign','5','',2,'',1137                    
--exec [proc_FillDropdown] 'Accesslevel','1','22''                    
--exec [proc_FillDropdown] 'Client','5','','','5'                    
--exec [proc_FillDropdown] 'Project','5','104,105,','34757',''                    
-- EXEC Proc_FillDropDown @option=N'Project',@option1=N'5',@option2=N'',@option3=N'34757'                    
--exec [proc_FillDropdown] 'Campaign','5','182','34757',''                    
--exec [proc_FillDropdown] 'PG','Campaign','2365','56','0'                    
--exec [proc_FillDropdown] 'Pilot','Campaign','2088','56','1'/                    
--exec [proc_FillDropdown] 'CDM','6','33,81','34757'                    
--exec [proc_FillDropdown] 'TM','5','33','34757','4143,9772,10564,12010'                    
--exec [proc_FillDropdown] 'AgentForQMS','5','33','7687','99999'                    
--exec [proc_FillDropdown] 'BackOfficeAgent','34757','5','22'                    
--'CDM'  --Option1:AccessLMID,Option2:ClientIDs,Option3:GlobalUserID                    
--exec Proc_FillDropDown @option=N'Agent',@option1=N'5',@option2=N'166',@option3=N'34757',@option4=N'38929'                    
--exec Proc_FillDropDown @option=N'GetTM',@option1=N'5',@option2=N'34757',@option3=N'165'                    
-- exec Proc_FillDropDown @option=N'BO_WorkGroupForDataEntry',@option1=N'499',@option2=N'16'                    
                    
--exec Proc_FillDropDown 'PG','Campaign','2365','34757','0'                    
--exec Proc_FillDropDown 'WAT_WorkGroups_EasyJet','16','24930','','0'                    
--exec Proc_FillDropDown 'BindAllDisPositionColumnName','90','','',''                    
CREATE PROCEDURE [dbo].[proc_FillDropdown]                    
    (                    
      @option VARCHAR(MAX) ,                    
      @option1 VARCHAR(MAX) = '' ,                    
      @option2 VARCHAR(MAX) = '' ,                    
      @option3 VARCHAR(MAX) = '' ,                    
      @option4 VARCHAR(MAX) = '' ,                    
      @option5 VARCHAR(MAX) = ''                      
    )                    
AS                    
    BEGIN                      
                      
        DECLARE @strsql VARCHAR(MAX);                      
  DECLARE @ClientID INT=0                      
                      
        SET @strsql = '';                      
        IF ( @option = 'SQuestions' )                    
            BEGIN                      
                SELECT  QuestionID ,                    
                        Question                    
                FROM    SecurityQuestions                    
                WHERE   FreezeStatus = 0;                      
            END;                      
        ELSE                    
            IF ( @option = 'ClientProjects' )                    
                BEGIN                    
                    SET @strsql = 'SELECT  P.ProjectID,P.ProjectName,CMM.DefaultProjectID DefaultProject                       
        FROM    ' + @option1                    
                        + '.dbo.Projects P                    
        JOIN dbo.ClientMappingMaster CMM ON CMM.ClientID = P.ClientID                        
        WHERE   CMM.ClientLoginID = '                    
                        + CAST(@option2 AS VARCHAR(50));                      
                    PRINT ( @strsql );                      
                    EXEC(@strsql);                      
                END;                    
            ELSE                    
                IF ( @option = 'UserProjects' )                    
                    BEGIN                    
                        SET @strsql = 'SELECT P.ProjectID, P.ProjectName, GUP.DefaultProject                      
        FROM ' + @option1        
                            + '.dbo.GlobalUserProjects GUP                    
        JOIN ' + @option1     
                            + '.dbo.Projects P ON P.ProjectID = GUP.ProjectID                    
        JOIN dbo.ClientLoginMappingDetail C ON C.ClientID = P.ClientID AND C.GlobalUserID ='                    
                  + @option2 + '                    
        WHERE GUP.GlobalUserID = ''' + @option2                    
     + '''                    
          AND GETDATE() BETWEEN GUP.StartDate AND                     
             CAST(CONVERT(VARCHAR(10),GUP.EndDate,121) + '' 23:59:59'' AS DATETIME)                     
        ';                    
                        PRINT ( @strsql );                      
    EXEC(@strsql);                      
                    END;                    
                ELSE                    
                    IF ( @option = 'AccessGroup' )               
                        BEGIN                    
                --------------------------- PN                    
 --     SELECT  CAST(AccessGroupTypeMID AS VARCHAR(10)) ID ,                  
    --                    AccessGroupType Name                    
    --            FROM    dbo.AccessGroupType                    
    --            WHERE   FreezeStatus = 0                    
    --            ORDER BY SrNo                     
                        
                            IF UPPER(@option1) = 'NONOPS'                    
                                BEGIN                    
                                    SELECT  CAST(AccessGroupTypeMID AS VARCHAR(10)) ID ,                    
                           AccessGroupType Name                    
                                    FROM    dbo.AccessGroupType                    
                                    WHERE   FreezeStatus = 0                    
                                            AND AccessGroupTypeMID NOT IN ( 1,                    
                                                              2, 3 )                    
                                    ORDER BY SrNo;                     
                                END;                    
                            ELSE                    
                                BEGIN                    
                                    SELECT  CAST(AccessGroupTypeMID AS VARCHAR(10)) ID ,                    
                                            AccessGroupType Name                    
                                    FROM    dbo.AccessGroupType                    
                                    WHERE   FreezeStatus = 0                    
                                    ORDER BY SrNo;                     
                                END;                    
     --------------------------- PN End                    
                        END;                
                  
                    ELSE                    
                        IF ( @option = 'Accesslevel' )                    
                            BEGIN                    
                                IF ( @option2 = '5' )                    
                                    SELECT  CAST(ALM.AccessLMID AS VARCHAR(10)) AS ID ,                    
                                            ALM.Accesslevel Name                    
                                    FROM    AccessLevelMaster ALM                    
                                            JOIN AccessLevelGroupMapping AGM ON ALM.AccessLMID = AGM.AccessLMID                    
                                    WHERE   AGM.AccessGroupTypeID = @option1                    
                                    ORDER BY ALM.OrderBy;                    
                                ELSE                    
                                    SELECT  CAST(ALM.AccessLMID AS VARCHAR(10)) AS ID ,                    
                                            ALM.Accesslevel Name                    
                                    FROM    AccessLevelMaster ALM                    
                                            JOIN AccessLevelGroupMapping AGM ON ALM.AccessLMID = AGM.AccessLMID                    
                                    WHERE   AGM.AccessGroupTypeID = @option1                    
                                            AND ALM.AccessLMID NOT IN ( 5 )                    
                                    ORDER BY ALM.OrderBy;                    
                            END;                    
                  
                  
        IF ( @option = 'DataUplaodQueueType' )                    
                            BEGIN                    
                                                  
                                    SELECT  CAST(QTM.QTMID AS VARCHAR(10)) AS ID ,                    
                          QTM.QueueType Name                    
                                    FROM    EasyJet_QueueTypeMaster QTM                   
                                                            
                                    WHERE   QTM.ClientID = @option1                  
                                    ORDER BY QTM.QueueType;                    
                                                 
                            END;                    
                  
                  
                  
                        ELSE                    
                  
         IF @option = 'Client'   --Option:Client,Option1 :AccessLMID,Option2 : LoginMID,Option3(not in use):GlobalUserID,Option4='1 DD or 0 no dd'                    
                                BEGIN                      
        set @Option4 =''                                       
       IF @option4 = ''                    
                                        BEGIN                    
                                            IF CAST(@option1 AS INT) = 5                    
                                                SELECT  ID = ClientID ,                    
     Name = ClientName                    
                                                FROM    EmeraldHierarchies_MVC.dbo.Clients                    
                                                WHERE   IsActive = 1                    
                                                ORDER BY ClientName;                       
                               
                                            ELSE                    
             SELECT DISTINCT                    
                                                        ID = CL.ClientID ,                    
                                                        Name = CL.ClientName                    
                                                FROM    EmeraldHierarchies_MVC.dbo.Clients CL                    
                                                        JOIN ClientLoginMappingDetail CLMD ON CL.ClientID = CLMD.ClientID                    
                                                              AND CLMD.[STATUS] = 0                    
                                                WHERE   CLMD.LoginMID = @option2                    
                                                        AND IsActive = 1                    
                                                ORDER BY CL.ClientName;                       
                                        END;                    
                                    ELSE                    
                                        BEGIN                    
                                     DECLARE @ddbo VARCHAR(200)= '';                                                            
                                            IF @option4 = '0'                    
                                                SET @ddbo = ' cmd.DataDefination = 0';                    
                                            ELSE                    
                                                IF @option4 = '1'                    
 SET @ddbo = ' cmd.DataDefination = 0 and cmd.FO=1';                    
                                                ELSE                    
                                                    IF @option4 = '2'                    
                                                        SET @ddbo = ' cmd.DataDefination = 0 and cmd.BO=1';                    
                                                    ELSE                    
                                                        SET @ddbo = ' cmd.DataDefination = 0';                    
                               
                                            IF CAST(@option1 AS INT) = 5                    
                                                SET @strsql = 'SELECT  ID = cl.ClientID ,                    
       Name = cl.ClientName                    
           FROM    EmeraldHierarchies_MVC.dbo.Clients cl                    
             INNER JOIN clientmasterdetail cmd ON cl.ClientID = cmd.ClientID                    
           WHERE   isactive = 1                    
             AND ' + @ddbo + '                    
           ORDER BY CL.ClientName';                    
                               
                                            ELSE                    
                                                SET @strsql = 'SELECT DISTINCT                    
             ID = cl.ClientID ,                    
             Name = cl.ClientName                    
           FROM    EmeraldHierarchies_MVC.dbo.Clients CL                    
             INNER JOIN clientmasterdetail cmd ON cl.ClientID = cmd.ClientID                    
             JOIN ClientLoginMappingDetail CLMD ON CL.ClientID = CLMD.ClientID and CLMD.[status]=0                    
           WHERE   CLMD.LoginMID = '                    
                                                    + @option2 + '                    
             AND CL.isactive = 1                    
             AND ' + @ddbo + '                    
           ORDER BY CL.ClientName';                    
                                        END;                        
                                    PRINT ( @strsql );                    
                                    EXEC (@strsql);                    
                                END;                    
                            ELSE                    
                                IF @option = 'Project'   --Option:Project,Option1 :AccessLMID,@Option2:ClientID,Option3 :GlobalUserID,Option4 : (Load projects without ClientID)                    
                                    BEGIN                    
                                        IF @option4 = ''                    
                                            BEGIN                    
   IF CAST(@option1 AS INT) = 5                    
                                                    BEGIN                    
                                                        IF @option2 = ''                    
                                                            SET @strsql = 'SELECT  ID = ProjectID ,                    
              Name = ProjectName                    
            FROM    EmeraldHierarchies_MVC.dbo.Projects                    
            WHERE   isactive = 1                    
            ORDER BY ProjectName';                    
                                              ELSE                    
                                                            SET @strsql = 'SELECT  ID = ProjectID ,                    
              Name = ProjectName                    
            FROM    EmeraldHierarchies_MVC.dbo.Projects                    
            WHERE   isactive = 1                    
              AND ClientID in ('                    
                                                              + @option2 + ')                    
            ORDER BY ProjectName';                                       
                                                    END;         
                                                ELSE                    
                                                    BEGIN                    
                                                        IF @option2 = ''                    
                                                            SET @strsql = 'SELECT DISTINCT                    
               ID = PJ.ProjectID ,                    
               Name = PJ.ProjectName                    
             FROM    EmeraldHierarchies_MVC.dbo.Projects PJ                    
               INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUserProjects GUP ON GUP.ProjectID = PJ.ProjectID                    
             WHERE   PJ.isactive = 1                                                                                
               AND GUP.freezestatus = 0                    
               AND GUP.GlobalUserID = '''                    
                                                              + @option3 + '''                    
            ORDER BY PJ.ProjectName';                    
                                                        ELSE                    
                                                            SET @strsql = 'SELECT DISTINCT                    
               ID = PJ.ProjectID ,                    
               Name = PJ.ProjectName                    
             FROM    EmeraldHierarchies_MVC.dbo.Projects PJ                    
               INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUserProjects GUP ON GUP.ProjectID = PJ.ProjectID                    
             WHERE   PJ.isactive = 1                    
               AND PJ.ClientID in ('                    
                                                              + @option2                    
                                                              + ')                    
               AND GUP.freezestatus = 0                    
               AND GUP.GlobalUserID = '''                    
                      + @option3 + '''                    
             ORDER BY PJ.ProjectName';                    
                                                    END;                    
                                                EXEC (@strsql);                    
                                            END;                    
                                        ELSE                    
                                            BEGIN                    
                                                DECLARE @DEFID VARCHAR(10);                    
                                                SELECT  @DEFID = ISNULL(( SELECT TOP 1                    
                                                              ProjectID                    
                                                              FROM                    
                                                              [EmeraldHierarchies_MVC].dbo.GlobalUserProjects                    
                                                              WHERE                    
                                           GlobalUserID = @option3                    
                                                              AND DefaultProject = 1                    
                                                              AND YEAR(EndDate) = 2099                    
                                                              ), 0);                    
                            
                                                IF CAST(@option1 AS INT) = 5                    
                                                BEGIN                    
                                                        SELECT DISTINCT                    
                                                              P.ProjectID ,                    
                                                              P.ProjectName ,                    
                                                              CASE   
                                                              WHEN P.ProjectID = @DEFID                    
                                                              THEN 1                    
                     ELSE 0                    
                                                              END AS [Checked] ,                    
                                                              @DEFID AS [DefaultProjectID]                    
                                                        FROM  [EmeraldHierarchies_MVC].dbo.Projects P                    
                                                        WHERE IsActive = 1;                    
                                                    END;                    
                                                ELSE                    
                                                    BEGIN                    
                                                        SELECT                    
                                                              P.ProjectID ,                    
                                                              P.ProjectName ,                    
                      CASE                    
                                                              WHEN P.ProjectID = @DEFID                    
                                                              THEN 1                    
       ELSE 0                    
                      END AS [Checked] ,                    
                   @DEFID AS [DefaultProjectID]                    
                                                        FROM  [EmeraldHierarchies_MVC].dbo.Projects P                    
       JOIN [EmeraldHierarchies_MVC].dbo.GlobalUserProjects GUP ON GUP.ProjectID = P.ProjectID                    
                                                              AND YEAR(GUP.EndDate) = 2099                    
                                                        WHERE GUP.GlobalUserID = @option3;                    
                                                    END;                    
                                            END;                    
                                    END;                    
                        
   IF @option = 'Campaign'   --Option:Project,Option1 :AccessLMID,@Option2:projectid,Option3 :GlobalUserID,Option4 : (Load all project without GlobaluserProject if not blank)                    
            BEGIN                     
   SELECT @ClientID=DefaultClientID FROM LOGINMASTER WHERE GlobalUserID=@option3                    
   IF(@ClientID=184)                    
     BEGIN                      
     ---SELECT  ProcessID AS ID,Process AS Name From Transunion.dbo.TUProcess WHERE ProjectID in (SELECT Data FROM dbo.Split(@option2,','))                    
     SET @strsql = 'SELECT  ProcessID AS ID,Process AS Name                    
        FROM    Transunion.dbo.TUProcess                    
        WHERE   ProjectID in (' + @option2 + ')                    
        ORDER BY Process';                    
        exec (@strsql)                    
     END                    
     ELSE                    
     BEGIN                    
                IF @option4 = ''                    
                    BEGIN                    
                        IF CAST(@option1 AS INT) = 5                    
                            SET @strsql = 'SELECT  ID = CampaignID ,                    
          Name = CampaignName                    
        FROM    EmeraldHierarchies_MVC.dbo.Campaigns                    
        WHERE   ProjectID in (' + @option2 + ')                    
        ORDER BY CampaignName';                    
                                       
                        ELSE                    
                            SET @strsql = 'SELECT DISTINCT                    
          ID = cam.CampaignID ,                    
          Name = cam.CampaignName                    
        FROM    EmeraldHierarchies_MVC.dbo.Campaigns cam                    
          INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUserProjects GUP ON GUP.ProjectID = cam.ProjectID                    
        WHERE   cam.ProjectID  in (' + @option2 + ')                    
          AND GUP.freezestatus = 0                    
          AND GUP.GlobalUserID = ''' + @option3                    
                         + '''                    
        ORDER BY cam.CampaignName';                    
                                                
                        EXEC (@strsql);                    
                    END;                    
                ELSE                    
   SELECT  ID = CampaignID ,                    
                            Name = CampaignName                    
                    FROM    EmeraldHierarchies_MVC.dbo.Campaigns                    
                    WHERE   ProjectID = @option2                    
                    ORDER BY CampaignName;                       
     END                    
            END;                       
        ELSE                    
            IF @option = 'PG'  --PG or Skills(telephony1) Option1=Project/Campaign/Client,Option2=ProjectValue/CampaignValue/ClientValue,Option3=GlobalUserID,Option4=DD (1\0)                    
                BEGIN                    
                    IF @option4 = '0'                    
                        BEGIN                   
                            IF ( @option1 = 'Project' )                    
                                SET @strsql = 'SELECT  ID = AvayaSplitSkill ,                    
              Name = RTRIM(LTRIM(AvayaSplitSkillName))                    
            FROM    EmeraldHierarchies_MVC.DBO.SplitSkillsMaster                    
            WHERE   ProjectID IN ( '                    
                                    + @option2 + ' )';                    
                            ELSE                    
                                IF ( @option1 = 'Campaign' )                    
                                    SET @strsql = 'SELECT  ID = AvayaSplitSkill ,                    
               Name = RTRIM(LTRIM(AvayaSplitSkillName))                    
             FROM    EmeraldHierarchies_MVC.DBO.SplitSkillsMaster                    
             WHERE   CampaignID IN ( '                    
                                        + @option2 + ' )';                    
                        END;                    
                    ELSE                    
                        BEGIN                    
                            IF ( @option1 = 'Project' )                    
                                SET @strsql = 'SELECT DISTINCT                    
              Name = TelephonyLevel1Name ,                    
              ID = TelephonyLevel1ID                    
 FROM  EmeraldHierarchies_MVC.dbo.ExternalClientMappingHierarchies                    
            WHERE   OrgHierarchyLevel2ID IN ( '                    
                                    + @option2                    
                                    + ' )                    
              AND TelephonyLevel1ID IS NOT NULL                    
              AND TelephonyLevel1Name <> ''''                    
            ';                      
              ELSE                    
                                IF ( @option1 = 'Campaign' )                    
                                    SET @strsql = 'SELECT DISTINCT                    
               Name = TelephonyLevel1Name ,                    
               ID = TelephonyLevel1ID                    
             FROM    EmeraldHierarchies_MVC.dbo.ExternalClientMappingHierarchies                    
             WHERE   OrgHierarchyLevel3ID IN ( '                    
                                        + @option2                    
                                        + ' )                    
               AND TelephonyLevel1ID IS NOT NULL                    
               AND TelephonyLevel1Name <> ''''';                      
                                ELSE                    
                                    SET @strsql = 'SELECT DISTINCT                    
              Name = TelephonyLevel1Name ,                    
              ID = TelephonyLevel1ID                    
            FROM    EmeraldHierarchies_MVC.dbo.ExternalClientMappingHierarchies                    
            WHERE   ClientID IN ( '                    
                                        + @option2                    
                                       + ' )                    
              AND TelephonyLevel1ID IS NOT NULL                    
              AND TelephonyLevel1Name <> ''''';                    
                                    
         END;                                    
                    PRINT ( @strsql );                      
                    EXEC (@strsql);                      
                END;                    
            ELSE                    
                IF @option = 'Pilot'  --Pilot or Call Type(telephony2) Option1=Project/Campaign,Option2=ProjectValue/CampaignValue,Option3=ClientID,Option4=DD (1\0)                    
                    BEGIN                    
                        IF @option4 = '0'                    
                            BEGIN                    
 IF ( @option1 = 'Project' )                    
                                    SET @strsql = 'SELECT  ID = AlcatelPilot ,                    
              Name = RTRIM(LTRIM(PilotName))                    
            FROM    EmeraldHierarchies_MVC.dbo.AlcatelPilots                    
    WHERE   ProjectID IN ( '                    
                                        + @option2 + ' )';                            
                                ELSE                    
                                    IF ( @option1 = 'Campaign' )                    
                                        SET @strsql = 'SELECT  ID = AlcatelPilot ,                    
              Name = RTRIM(LTRIM(PilotName))                    
            FROM    EmeraldHierarchies_MVC.dbo.AlcatelPilots                    
            WHERE   CampaignID IN ( '                    
                                            + @option2 + ' )';                    
                            END;                    
    ELSE                    
                            BEGIN                    
                    IF ( @option1 = 'Project' )                    
                                    SET @strsql = 'SELECT DISTINCT                    
              Name = TelephonyLevel2Name ,                    
              ID = TelephonyLevel2ID                    
            FROM    EmeraldHierarchies_MVC.dbo.ExternalClientMappingHierarchies                    
            WHERE   OrgHierarchyLevel2ID IN ( '                    
                                        + @option2                    
                                        + ' )                    
              AND TelephonyLevel2ID IS NOT NULL                    
              AND TelephonyLevel2Name <> ''''                    
            ';                    
                                ELSE                    
                                    IF ( @option1 = 'Campaign' )                    
               SET @strsql = 'SELECT DISTINCT                    
              Name = TelephonyLevel2Name ,                    
              ID = TelephonyLevel2ID                    
            FROM    EmeraldHierarchies_MVC.dbo.ExternalClientMappingHierarchies                    
            WHERE   OrgHierarchyLevel3ID IN ( '                    
                                            + @option2                    
                                            + ' )                    
              AND TelephonyLevel2ID IS NOT NULL                    
              AND TelephonyLevel2Name <> ''''                    
            ';                    
                                    ELSE                    
                                        SET @strsql = 'SELECT DISTINCT                    
              Name = TelephonyLevel2Name ,                    
              ID = TelephonyLevel2ID                    
            FROM    EmeraldHierarchies_MVC.dbo.ExternalClientMappingHierarchies                    
            WHERE   ClientID IN ( '                    
       + @option3                    
                                            + ' )                    
              AND TelephonyLevel2ID IS NOT NULL                    
              AND TelephonyLevel2Name <> ''''';                    
                                    
                            END;                                    
                        PRINT ( @strsql );                      
                        EXEC (@strsql);                      
                    END;               
     ELSE                    
                    IF @option = 'CDD'  --Option1:AccessLMID,Option2:ClientIDs,Option3:GlobalUserID                    
                        BEGIN                    
                            DECLARE @ClientStrCDD VARCHAR(500)= ''                    
                            IF ( @option2 <> '' )                    
                                BEGIN                    
 SET @ClientStrCDD = 'AND c.ClientID in ('                    
                                        + @option2 + ')'                    
                                END                    
                            IF @option1 = '5'                    
                                SET @strsql = 'SELECT DISTINCT                    
            Name = gu.FirstName + '' '' + gu.LastName ,                    
            ID = gu.GlobalUserID                    
          FROM    EmeraldHierarchies_MVC.dbo.GlobalUsers gu                    
            INNER JOIN EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers HRGU ON HRGU.GlobalUserID = gu.GlobalUserID                    
                          AND HRGU.RoleLeaveDate IS NULL                    
            INNER JOIN EmeraldHierarchies_MVC.dbo.Clients c ON CAST(c.ClientID AS VARCHAR(50)) = HRGU.ClientID                    
            INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUserRoles gur ON gur.GlobalUserID = gu.GlobalUserID                    
                          AND ISNULL(gur.freezestatus,                    
                          0) = 0                    
          WHERE   1 = 1                    
            ' + @ClientStrCDD                    
                                    + '                    
            AND gu.GlobalUserID NOT IN ( SELECT GlobalUserID                    
                    FROM   Prism_Datamart_MVC.dbo.LoginMaster                    
                    WHERE  AccessLMID IN ( 5, 6 ) )                    
            AND gur.GlobalUserRoleTypeID = 2                    
          '                    
                            ELSE                    
                                IF ( @option1 = '6' )                    
                                    SET @strsql = 'SELECT DISTINCT Name=gu.FirstName + '' '' + gu.LastName,ID=gu.GlobalUserID                    
               FROM    EmeraldHierarchies_MVC.dbo.GlobalUsers gu                     
                 inner join EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers HRGU on HRGU.GlobalUserID=gu.GlobalUserID and HRGU.RoleLeaveDate IS NULL                     
                 INNER JOIN EmeraldHierarchies_MVC.dbo.Clients c ON cast(c.ClientID as varchar(50))=HRGU.ClientID                    
                 INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUserRoles gur ON gur.GlobalUserID = gu.GlobalUserID  and isnull(gur.freezestatus,0)=0                    
               WHERE 1=1   '               
                                        + @ClientStrCDD                    
                                        + ' AND                     
                 c.ClientID in (select distinct ClientID from ClientLoginMappingDetail where globaluserid='''                    
                                        + @Option3                    
             + ''' and [status]=0)                    
                 and                    
                 gu.GlobalUserID NOT IN (                    
                 SELECT  GlobalUserID                    
                 FROM    Prism_Datamart_MVC.dbo.LoginMaster                    
                 WHERE   AccessLMID IN ( 5, 6 ) )                    
                 AND gur.GlobalUserRoleTypeID = 3'                    
                                ELSE                    
                                    SET @strsql = 'SELECT DISTINCT  Name=gu.FirstName + '' '' + gu.LastName,ID=gu.GlobalUserID                    
          FROM EmeraldHierarchies_MVC.dbo.GlobalUsers gu                     
            inner join EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers HRGU on HRGU.GlobalUserID=gu.GlobalUserID and HRGU.RoleLeaveDate IS NULL                     
            INNER JOIN EmeraldHierarchies_MVC.dbo.Clients c ON cast(c.ClientID as varchar(50))=HRGU.ClientID                    
            INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUserRoles gur ON gur.GlobalUserID = gu.GlobalUserID and isnull(gur.freezestatus,0)=0                    
          WHERE  1=1  ' + @ClientStrCDD                    
                                        + ' AND                     
             c.ClientID in (select distinct ClientID from ClientLoginMappingDetail where globaluserid='''                    
                                     + @Option3                    
                                        + ''' and [status]=0)                    
            AND gu.GlobalUserID NOT IN (                    
            SELECT  GlobalUserID                    
            FROM    Prism_Datamart_MVC.dbo.LoginMaster                    
            WHERE   AccessLMID IN ( 5, 6 ) )                    
            AND gur.GlobalUserRoleTypeID = 2                    
            AND gur.ParentGlobalUserID='''                    
                        + @Option3 + ''''                        
                                
                            PRINT ( @strsql )                    
                            EXEC(@strsql)                        
                        END                    
                ELSE                    
                   IF @option = 'CDM'  --Option1:AccessLMID,Option2:ClientIDs,Option3:GlobalUserID                    
                        BEGIN                    
                            DECLARE @ClientStr VARCHAR(500)= ''                    
        DECLARE @CDDStr VARCHAR(500)= ''                    
                            IF ( @option2 <> '' )                    
                                BEGIN                    
                                    SET @ClientStr = ' AND c.ClientID in ('                    
                                        + @option2 + ')'                    
                                END                    
        IF ( @option4 <> '' )                    
            BEGIN                   
                                    SET @CDDStr = ' AND gur.ParentGlobalUserID in ('                    
                                        + @option4 + ')'                    
                                END                    
                            IF @option1 = '5'                    
                                SET @strsql = 'SELECT DISTINCT                    
            Name = gu.FirstName + '' '' + gu.LastName ,                    
            ID = gu.GlobalUserID                    
          FROM    EmeraldHierarchies_MVC.dbo.GlobalUsers gu                    
            INNER JOIN EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers HRGU ON HRGU.GlobalUserID = gu.GlobalUserID                    
                          AND HRGU.RoleLeaveDate IS NULL                    
            INNER JOIN EmeraldHierarchies_MVC.dbo.Clients c ON CAST(c.ClientID AS VARCHAR(50)) = HRGU.ClientID                    
            INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUserRoles gur ON gur.GlobalUserID = gu.GlobalUserID                    
                          AND ISNULL(gur.freezestatus,                    
                          0) = 0                    
          WHERE   1 = 1                    
            ' + @ClientStr                    
                    + '                    
            AND gu.GlobalUserID NOT IN ( SELECT GlobalUserID                    
                    FROM   Prism_Datamart_MVC.dbo.LoginMaster                    
                    WHERE  AccessLMID IN ( 5, 6 ) )                    
            AND gur.GlobalUserRoleTypeID = 3 '+@CDDStr                    
                            ELSE                    
                                IF ( @option1 = '6' )                    
                                    SET @strsql = 'SELECT DISTINCT Name=gu.FirstName + '' '' + gu.LastName,ID=gu.GlobalUserID                    
               FROM    EmeraldHierarchies_MVC.dbo.GlobalUsers gu                 
                 inner join EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers HRGU on HRGU.GlobalUserID=gu.GlobalUserID and HRGU.RoleLeaveDate IS NULL                     
                 INNER JOIN EmeraldHierarchies_MVC.dbo.Clients c ON cast(c.ClientID as varchar(50))=HRGU.ClientID                    
                 INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUserRoles gur ON gur.GlobalUserID = gu.GlobalUserID  and isnull(gur.freezestatus,0)=0                    
               WHERE 1=1   '                    
                                        + @ClientStr                    
                                        + ' AND                     
                 c.ClientID in (select distinct ClientID from ClientLoginMappingDetail where globaluserid='''                    
                                        + @Option3                    
                                        + ''' and [status]=0)                    
                 and                    
                 gu.GlobalUserID NOT IN (                    
                 SELECT  GlobalUserID                    
                 FROM    Prism_Datamart_MVC.dbo.LoginMaster                    
         WHERE   AccessLMID IN ( 5, 6 ) )                    
                 AND gur.GlobalUserRoleTypeID = 3 '+@CDDStr                    
   ELSE                    
                                    SET @strsql = 'SELECT DISTINCT  Name=gu.FirstName + '' '' + gu.LastName,ID=gu.GlobalUserID                    
          FROM EmeraldHierarchies_MVC.dbo.GlobalUsers gu                     
            inner join EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers HRGU on HRGU.GlobalUserID=gu.GlobalUserID and HRGU.RoleLeaveDate IS NULL                     
            INNER JOIN EmeraldHierarchies_MVC.dbo.Clients c ON cast(c.ClientID as varchar(50))=HRGU.ClientID                    
            INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUserRoles gur ON gur.GlobalUserID = gu.GlobalUserID and isnull(gur.freezestatus,0)=0                    
          WHERE  1=1  ' + @ClientStr                    
                                        + ' AND                     
             c.ClientID in (select distinct ClientID from ClientLoginMappingDetail where globaluserid='''                    
          + @Option3                    
                                        + ''' and [status]=0)                    
            AND gu.GlobalUserID NOT IN (                    
            SELECT  GlobalUserID                    
            FROM    Prism_Datamart_MVC.dbo.LoginMaster                    
            WHERE   AccessLMID IN ( 5, 6 ) )                    
            AND gur.GlobalUserRoleTypeID = 3                    
            AND gur.ParentGlobalUserID='''                   
                                        + @Option3 + '''' +@CDDStr                       
                                
             PRINT ( @strsql )                    
                            EXEC(@strsql)                        
                        END                    
                    ELSE                    
                        IF @option = 'TM'  --Option1:AccessLMID,Option2:ClientIDs,Option3:GlobalUserID,Option4:GlobalUserids                    
                            BEGIN                      
                                DECLARE @noclientfiler VARCHAR(500)= '';                    
                                DECLARE @parentstring VARCHAR(500)= '';                    
   DECLARE @parentstringAdmin VARCHAR(500)= '';                    
                                IF @option4 <> ''                    
                                    BEGIN                     
      --set @Option3=@Option4                    
                                        SET @parentstring = ' AND gur.ParentGlobalUserID in ('                    
                                            + @option4 + ')';                    
                                        SET @parentstringAdmin = ' AND gur.ParentGlobalUserID in ('                    
         + @option4 + ')';                    
                                    END;                   
                                ELSE                    
                                    SET @parentstring = ' AND gur.ParentGlobalUserID in ('                    
                                        + @option3 + ')';                    
                                IF @option2 != ''                    
                                    SET @noclientfiler = 'c.ClientID in ('                    
                                        + @option2 + ') AND ';                    
                          
                          
                                IF @option1 = '5'                    
                                    SET @strsql = 'SELECT DISTINCT Name=gu.FirstName + '' '' + gu.LastName,ID=gu.GlobalUserID                    
               FROM    EmeraldHierarchies_MVC.dbo.GlobalUsers gu                     
                 inner join EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers HRGU on HRGU.GlobalUserID=gu.GlobalUserID and HRGU.RoleLeaveDate IS NULL                     
                 INNER JOIN EmeraldHierarchies_MVC.dbo.Clients c ON cast(c.ClientID as varchar(50))=HRGU.ClientID                    
                 INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUserRoles gur ON gur.GlobalUserID = gu.GlobalUserID and isnull(gur.freezestatus,0)=0                    
               WHERE   '                    
                                        + @noclientfiler                    
                                        + '                    
                 gu.GlobalUserID NOT IN (                    
                 SELECT  GlobalUserID                    
                 FROM    Prism_Datamart_MVC.dbo.LoginMaster                    
                 WHERE   AccessLMID IN ( 5, 6 ) )                    
                 AND gur.GlobalUserRoleTypeID = 4'                    
                                        + @parentstringAdmin + ' ORDER BY 1';                    
                                ELSE                    
                                    IF ( @option1 = '6' )                    
                                        SET @strsql = 'SELECT DISTINCT Name=gu.FirstName + '' '' + gu.LastName,ID=gu.GlobalUserID                    
               FROM    EmeraldHierarchies_MVC.dbo.GlobalUsers gu                     
                 inner join EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers HRGU on HRGU.GlobalUserID=gu.GlobalUserID and HRGU.RoleLeaveDate IS NULL                     
                 INNER JOIN EmeraldHierarchies_MVC.dbo.Clients c ON cast(c.ClientID as varchar(50))=HRGU.ClientID                    
                 INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUserRoles gur ON gur.GlobalUserID = gu.GlobalUserID  and isnull(gur.freezestatus,0)=0                
               WHERE   '                    
                                       + @noclientfiler                    
    + ' c.ClientID in (select distinct ClientID from ClientLoginMappingDetail where globaluserid IN ('                    
                                            + @option3                    
                                            + ') and [status]=0)                    
                and                    
                 gu.GlobalUserID NOT IN (                    
                 SELECT  GlobalUserID                    
                 FROM   Prism_Datamart_MVC.dbo.LoginMaster                    
                 WHERE   AccessLMID IN ( 5, 6 ) )                    
                 AND gur.GlobalUserRoleTypeID = 4'                    
                                            + @parentstringAdmin                    
                                            + ' ORDER BY 1';                    
                   ELSE                    
                                        SET @strsql = 'SELECT DISTINCT  Name=gu.FirstName + '' '' + gu.LastName,ID=gu.GlobalUserID                    
          FROM EmeraldHierarchies_MVC.dbo.GlobalUsers gu                     
            inner join EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers HRGU on HRGU.GlobalUserID=gu.GlobalUserID and HRGU.RoleLeaveDate IS NULL                     
            INNER JOIN EmeraldHierarchies_MVC.dbo.Clients c ON cast(c.ClientID as varchar(50))=HRGU.ClientID                    
            INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUserRoles gur ON gur.GlobalUserID = gu.GlobalUserID and isnull(gur.freezestatus,0)=0                    
          WHERE   ' + @noclientfiler                    
                                            + ' c.ClientID in (select distinct ClientID from ClientLoginMappingDetail where globaluserid IN ('                    
                                            + @option3                    
                                            + ') and [status]=0)                    
            AND gu.GlobalUserID NOT IN (                    
            SELECT  GlobalUserID                    
            FROM    Prism_Datamart_MVC.dbo.LoginMaster                    
            WHERE   AccessLMID IN ( 5, 6 ) )                    
            AND gur.GlobalUserRoleTypeID = 4'                    
                    + @parentstring + ' ORDER BY 1';                    
                                
                                PRINT ( @strsql );                    
                                EXEC(@strsql);                        
                            END;                     
                        ELSE                    
                            IF @option = 'Agent'  --Option1:AccessLMID,Option2:ClientIDs,Option3:GlobalUserID,Option4:GlobalUserids                    
                                BEGIN                      
                                    DECLARE @noclientfilerAgent VARCHAR(500)= '';                    
                                    DECLARE @parentstringAgent VARCHAR(500)= '';                    
                                    DECLARE @parentstringAdminAgent VARCHAR(500)= '';                    
                                    IF @option4 = ''                    
                                        BEGIN                     
                                            SET @parentstringAgent = ' AND gur.ParentGlobalUserID in ('                    
                                                + @option3 + ')';                          
                                        END;                    
                                    ELSE                    
                                        IF @option4 = '99999'                    
                                            BEGIN                     
                                     SET @parentstringAgent = ' ';                    
                      END;                    
                           ELSE                    
                                            BEGIN                    
                                                SET @parentstringAgent = ' AND gur.ParentGlobalUserID in ('                    
                                                    + @option4 + ')';                    
                                     SET @parentstringAdminAgent = ' AND gur.ParentGlobalUserID in ('                    
                                                    + @option4 + ')';                    
                                            END;                      
                          
                          
                                    IF @option2 != ''                    
                                        SET @noclientfilerAgent = 'c.ClientID in ('                    
                                            + @option2 + ') AND ';                    
                          
         IF @option1 = '5'                    
                                        SET @strsql = 'SELECT DISTINCT Name=gu.FirstName + '' '' + gu.LastName,ID=gu.GlobalUserID                    
               FROM    EmeraldHierarchies_MVC.dbo.GlobalUsers gu                     
                 inner join EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers HRGU on HRGU.GlobalUserID=gu.GlobalUserID and HRGU.RoleLeaveDate IS NULL                     
                 INNER JOIN EmeraldHierarchies_MVC.dbo.Clients c ON cast(c.ClientID as varchar(50))=HRGU.ClientID                    
                 INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUserRoles gur ON gur.GlobalUserID = gu.GlobalUserID and isnull(gur.freezestatus,0)=0                    
               WHERE   '                    
                                            + @noclientfilerAgent                    
                                            + ' gu.GlobalUserID NOT IN (                    
                 SELECT  GlobalUserID                    
                 FROM    Prism_Datamart_MVC.dbo.LoginMaster                    
                 WHERE   AccessLMID IN ( 5, 6 ) )                    
                 AND gur.GlobalUserRoleTypeID = 5'                    
                                            + @parentstringAdminAgent                    
                                            + ' ORDER BY 1';                    
                                    ELSE                    
                                        IF ( @option1 = '6' )                    
                                            SET @strsql = 'SELECT DISTINCT Name=gu.FirstName + '' '' + gu.LastName,ID=gu.GlobalUserID                    
               FROM    EmeraldHierarchies_MVC.dbo.GlobalUsers gu                     
                 inner join EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers HRGU on HRGU.GlobalUserID=gu.GlobalUserID and HRGU.RoleLeaveDate IS NULL                     
                 INNER JOIN EmeraldHierarchies_MVC.dbo.Clients c ON cast(c.ClientID as varchar(50))=HRGU.ClientID                    
                 INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUserRoles gur ON gur.GlobalUserID = gu.GlobalUserID  and isnull(gur.freezestatus,0)=0                    
               WHERE   '                    
                                                + @noclientfilerAgent                    
                                                + ' c.ClientID in (select distinct ClientID from ClientLoginMappingDetail where globaluserid='''                    
                                                + @option3                    
                                                + ''' and [status]=0)                    
                and                    
                 gu.GlobalUserID NOT IN (                    
                 SELECT  GlobalUserID                    
                 FROM    Prism_Datamart_MVC.dbo.LoginMaster                    
                 WHERE   AccessLMID IN ( 5, 6 ) )                    
     AND gur.GlobalUserRoleTypeID = 5'                    
                                                + @parentstringAdminAgent                    
                                                + ' ORDER BY 1';                    
                                        ELSE                    
                                            SET @strsql = 'SELECT DISTINCT  Name=gu.FirstName + '' '' + gu.LastName,ID=gu.GlobalUserID                    
      FROM EmeraldHierarchies_MVC.dbo.GlobalUsers gu                     
            inner join EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers HRGU on HRGU.GlobalUserID=gu.GlobalUserID and HRGU.RoleLeaveDate IS NULL                     
            INNER JOIN EmeraldHierarchies_MVC.dbo.Clients c ON cast(c.ClientID as varchar(50))=HRGU.ClientID                    
            INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUserRoles gur ON gur.GlobalUserID = gu.GlobalUserID and isnull(gur.freezestatus,0)=0                    
          WHERE    ' + @noclientfilerAgent                    
                                                + ' c.ClientID in (select distinct ClientID from ClientLoginMappingDetail where globaluserid='''                    
                                                + @option3                    
                                                + ''' and [status]=0)                    
            AND gu.GlobalUserID NOT IN (       
            SELECT  GlobalUserID                    
            FROM    Prism_Datamart_MVC.dbo.LoginMaster                    
            WHERE   AccessLMID IN ( 5, 6 ) )                    
            AND gur.GlobalUserRoleTypeID = 5'                    
    + @parentstringAgent           
                                                + ' ORDER BY 1';                    
                                
                                    PRINT ( @strsql );                    
                              EXEC(@strsql);                        
                                END;                     
                    ELSE                    
                                IF ( @option = 'AgentForQMS' )                    
                                    BEGIN                    
                                        DECLARE @parentstringAgent1 VARCHAR(500)= '';                    
                                        DECLARE @parentstringAdminAgent1 VARCHAR(500)= '';                    
                                        IF @option4 = '99999'                    
                                            BEGIN                     
                                                SET @parentstringAgent1 = ' AND gur.ParentGlobalUserID in (Select GUR.GlobalUserID                     
                       FROM EmeraldHierarchies_MVC.dbo.GlobalUserRoles GUR                     
                       JOIN EmeraldHierarchies_MVC.dbo.GlobalUserProjects GUP ON GUP.GlobalUserID = GUR.GlobalUserID                     
                                    AND GUP.FreezeStatus = 0                    
                       WHERE GUR.GlobalUserRoleTypeID = 4 AND GUR.FreezeStatus = 0 AND GUP.ProjectID IN ('                    
                                                    + @option2                    
                                                    + ')                    
                       )';                    
                                          END;                    
                                        ELSE                    
                                            IF @option4 = ''                    
                                                BEGIN                     
                                                    SET @parentstringAgent1 = ' AND gur.ParentGlobalUserID = 0';                    
      END;                    
                                            ELSE                    
                                                BEGIN                    
          SET @parentstringAgent1 = ' AND gur.ParentGlobalUserID in ('                    
                                                        + @option4 + ')';                    
                                                    SET @parentstringAdminAgent1 = ' AND gur.ParentGlobalUserID in ('                    
                                                        + @option4 + ')';                    
                                                END;                    
                             
                                IF @option1 = '5'                    
                                            SET @strsql = 'SELECT DISTINCT Name=gu.FirstName + '' '' + gu.LastName,ID=gu.GlobalUserID                    
           FROM    EmeraldHierarchies_MVC.dbo.GlobalUsers gu                     
             inner join EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers HRGU on HRGU.GlobalUserID=gu.GlobalUserID and HRGU.RoleLeaveDate IS NULL                     
             INNER JOIN EmeraldHierarchies_MVC.dbo.Clients c ON cast(c.ClientID as varchar(50))=HRGU.ClientID                    
             INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUserRoles gur ON gur.GlobalUserID = gu.GlobalUserID and isnull(gur.freezestatus,0)=0                    
           WHERE   gu.GlobalUserID NOT IN ( SELECT  GlobalUserID                    
                    FROM    Prism_Datamart_MVC.dbo.LoginMaster                    
                    WHERE   AccessLMID IN ( 5, 6 ) )                    
                    AND gur.GlobalUserRoleTypeID = 5'                    
                                                + @parentstringAgent1;                    
                                        ELSE                    
                                            IF ( @option1 = '6' )                    
                                                SET @strsql = 'SELECT DISTINCT Name=gu.FirstName + '' '' + gu.LastName,ID=gu.GlobalUserID                    
                    FROM    EmeraldHierarchies_MVC.dbo.GlobalUsers gu                     
 inner join EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers HRGU on HRGU.GlobalUserID=gu.GlobalUserID and HRGU.RoleLeaveDate IS NULL                     
                      INNER JOIN EmeraldHierarchies_MVC.dbo.Clients c ON cast(c.ClientID as varchar(50))=HRGU.ClientID                    
                      INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUserRoles gur ON gur.GlobalUserID = gu.GlobalUserID  and isnull(gur.freezestatus,0)=0                    
                    WHERE   c.ClientID in (select distinct ClientID from ClientLoginMappingDetail where globaluserid='''                    
                                                    + @option3                    
                                                    + ''' and [status]=0)                    
                     and                    
                      gu.GlobalUserID NOT IN (                    
                      SELECT  GlobalUserID                    
                      FROM    Prism_Datamart_MVC.dbo.LoginMaster                    
                      WHERE   AccessLMID IN ( 5, 6 ) )                    
           AND gur.GlobalUserRoleTypeID = 5'                    
                                                    + @parentstringAdminAgent1;                    
                                            ELSE                    
                                                SET @strsql = 'SELECT DISTINCT  Name=gu.FirstName + '' '' + gu.LastName,ID=gu.GlobalUserID                    
               FROM EmeraldHierarchies_MVC.dbo.GlobalUsers gu                     
                 inner join EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers HRGU on HRGU.GlobalUserID=gu.GlobalUserID and HRGU.RoleLeaveDate IS NULL                     
                 INNER JOIN EmeraldHierarchies_MVC.dbo.Clients c ON cast(c.ClientID as varchar(50))=HRGU.ClientID                    
                 INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUserRoles gur ON gur.GlobalUserID = gu.GlobalUserID and isnull(gur.freezestatus,0)=0                    
               WHERE    c.ClientID in (select distinct ClientID from ClientLoginMappingDetail where globaluserid='''                    
                                                    + @option3                    
                                                    + ''' and [status]=0)                    
                 AND gu.GlobalUserID NOT IN (                    
              SELECT  GlobalUserID                    
                 FROM    Prism_Datamart_MVC.dbo.LoginMaster                    
                 WHERE   AccessLMID IN ( 5, 6 ) )                    
                 AND gur.GlobalUserRoleTypeID = 5'                    
                                                    + @parentstringAgent1;                    
                                
                                        PRINT ( @strsql );                    
                                        EXEC(@strsql);                    
                    
                                    END;                    
                                ELSE                    
                                    IF ( @option = 'ClientForEmployeeUpload' )                    
                                        BEGIN                            
                                            IF ( CAST(@option3 AS INT) >= 5 )                    
                                                BEGIN                    
                                     
          SELECT  CL.ClientID ,                    
                                                            CL.ClientName                    
                                                    FROM    EmeraldHierarchies_MVC.dbo.Clients CL                    
                                                            JOIN EmeraldHierarchies_MVC.dbo.HRSystemSources HRSS ON HRSS.ClientID = CL.ClientID                    
                                                              AND HRSS.IsActive = 1                    
                                                    ORDER BY CL.ClientName;                      
                                                END;                    
                                            ELSE                    
                                                BEGIN                    
                                               SELECT DISTINCT                    
                                                            CL.ClientID ,                    
                                                            CL.ClientName                    
                                                    FROM    EmeraldHierarchies_MVC.dbo.GlobalUsers GU                    
                                                            JOIN EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers HRGU ON GU.GlobalUserID = HRGU.GlobalUserID                    
                                                              AND YEAR(GU.InactiveDate) = '2099'                    
                                                              AND HRGU.RoleLeaveDate IS NULL                    
            JOIN EmeraldHierarchies_MVC.dbo.HRSystemSources HSS ON HSS.HRSystemSourcesID = HRGU.HRSystemSourcesID            
                                                 JOIN EmeraldHierarchies_MVC.dbo.Clients CL ON CL.ClientID = HSS.ClientID                    
                                                    WHERE   GU.GlobalUserID = CAST(@option2 AS INT);                    
                                                END;                    
                                        END;                       
                                    ELSE                    
                                        IF ( @option = 'AccesslevelAll' )                    
                                            BEGIN                    
                                                SELECT  CAST(AccessLMID AS VARCHAR(10)) AS ID ,                    
                                                        Accesslevel Name                    
                                                FROM    AccessLevelMaster                    
                                                ORDER BY AccessLMID;                    
                                                    
                                            END;                    
                                                
                                        ELSE                    
                                            IF @option = '60'                    
                                                BEGIN                           
                                                    IF @option1 = 'From'                    
                                                        SELECT                    
                                                              HourlyInterval id ,                    
                                                          LEFT(CONVERT(VARCHAR, CAST(MIN(Startinterval) AS DATETIME), 108),                    
                                                              5) Name                    
                                                        FROM  TimeIntervalGrouping                    
                                                        GROUP BY HourlyInterval                    
                                                        ORDER BY 1;                        
                                                    ELSE                    
     SELECT                    
                                                              HourlyInterval id ,                    
                                                              LEFT(CONVERT(VARCHAR, CAST(MAX(EndInterval) AS DATETIME), 108),                    
                                                              5) Name                    
                                                        FROM  TimeIntervalGrouping                    
                                        GROUP BY HourlyInterval                    
                                                        ORDER BY 1;                          
                                                END;                    
                                            ELSE                    
                                                IF @option = 'WorkGroup' --Option1:AccessLMID,Option2:GlobalUserID,Option3:CampaignIDs                    
                                                    BEGIN                                      
                                                        SET @strsql = 'select distinct Name=WorkGroupName, ID=WGM.WorkGMID from WAT_WorkGroupMaster WGM join                               
        WAT_WorkGroupCampaignDetail WGCM on wgm.WorkGMID=WGCM.WorkGMID and WGCM.CampaignID in ('                    
                                                            + @option3 + ')';                                  
                                                        PRINT ( @strsql );                                      
                                                        EXEC (@strsql);                                      
                                                    END;                               
                                                ELSE                    
                                       IF @option = 'WorkDivision'--Option1:AccessLMID,Option2:GlobalUserID,Option3:WorkGroupIDs                    
                                                        BEGIN                                      
                                                            SET @strsql = 'select distinct Name=WorkDivisionName,ID=WDM.WorkDMID from WAT_WorkDivisionMaster WDM                               
     join WAT_WorkGroupWorkDivisionDetail WGWDD on WDM.WorkDMID=WGWDD.WorkDMID                              
     where WGWDD.WorkGMID in (' + @option3 + ')';                                  
                                                            PRINT ( @strsql );                                      
                    EXEC (@strsql);                                      
                                                        END;                    
        IF @option = 'HRSites'                    
            BEGIN                    
                IF @option3 = '216'                    
                    AND @option2 <> ''                    
                    BEGIN                    
                        SET @strsql = 'SELECT  distinct ID = HRSitesID ,                    
                            Name = HRSiteName                    
                    FROM    EmeraldHierarchies_MVC.dbo.HRSites hsite                    
                            INNER JOIN EmeraldHierarchies_MVC.dbo.CampaignSiteMapping  hsource ON hsource.SiteID = hsite.HRSitesID                    
                    WHERE   hsite.isactive = 1 and hsource.CampaignId in  ('                    
                            + @option2 + ') Order by  hsite.HRSiteName';                    
                        EXEC(@strsql);                  
                    END;                    
                ELSE                    
                    IF @option1 != ''                    
                        BEGIN                    
                            SET @strsql = 'SELECT  ID = HRSitesID ,                    
                            Name = HRSiteName                    
                    FROM    EmeraldHierarchies_MVC.dbo.HRSites hsite                    
                            INNER JOIN EmeraldHierarchies_MVC.dbo.HRSystemSources hsource ON hsource.HRSystemSourcesID = hsite.HRSystemSourcesID                    
                    WHERE   hsite.isactive = 1                    
                            AND hsource.ClientID = ' + @option3;                       
                            PRINT @strsql;                    
                            EXEC(@strsql);                       
              END;                          
                    ELSE                    
                        BEGIN                    
                            SET @strsql = 'SELECT  ID = HRSourceSiteID ,                    
                            Name = HRSitesID                    
                    FROM    EmeraldHierarchies_MVC.dbo.HRSites hsite                    
                            INNER JOIN EmeraldHierarchies_MVC.dbo.HRSystemSources hsource ON hsource.HRSystemSourcesID = hsite.HRSystemSourcesID                    
                    WHERE   hsite.isactive = 1 AND hsource.ClientID ='                    
                                + @option3;                    
                            PRINT @strsql;                    
                            EXEC(@strsql);                       
                        END;                    
            END;                     
        ELSE                    
            IF @option = 'HRPosts'                    
                BEGIN                    
                IF @option1 != ''                    
                        SELECT  ID = HRSPostsID ,                    
                                Name = HRPostName                    
                        FROM    EmeraldHierarchies_MVC.dbo.HRPosts hpost                    
                                INNER JOIN EmeraldHierarchies_MVC.dbo.HRSystemSources hsource ON hsource.HRSystemSourcesID = hpost.HRSystemSourcesID                    
                        WHERE   hpost.IsActive = 1                    
                              AND hsource.ClientID = @option1;                                
                    ELSE                    
                        SELECT  ID = HRSPostsID ,                    
                                Name = HRPostName                    
                        FROM    EmeraldHierarchies_MVC.dbo.HRPosts hpost     
                                INNER JOIN EmeraldHierarchies_MVC.dbo.HRSystemSources hsource ON hsource.HRSystemSourcesID = hpost.HRSystemSourcesID                    
                        WHERE   hpost.IsActive = 1;                    
                END;                     
            ELSE                    
                IF @option = 'HRRoleType'                    
                    BEGIN                    
                        SELECT  ID = GlobalUserRoleTypeID ,                    
                                Name = RoleName                    
                        FROM    EmeraldHierarchies_MVC.dbo.GlobalUserRoleTypes;                    
                    END;                    
                ELSE                    
                    IF @option = 'ThemeList'                    
        BEGIN                    
                            SELECT  ThemeMID ,                    
       ThemeName ,                    
                           CSSKey ,                    
              [ThemeImage] = ImagePath                    
                            FROM    ThemeMaster                    
                            WHERE   FreezeStatus = 0;                    
                        END;                    
            ELSE              
                        IF @option = 'Domain'                    
                            BEGIN                    
                                SELECT  CAST(ADMID AS VARCHAR(10)) AS ID ,                    
                                        Name = ADName                    
                             FROM    dbo.ADMaster                    
                                WHERE   FreezeStatus = 0                    
                                ORDER BY 1;                    
   END;                    
                        ELSE                    
                            IF @option = 'DomainPath'                    
                                BEGIN                    
                                    SELECT  CAST(ADMID AS VARCHAR(10)) + '~'                    
                                            + ADPath AS ID ,                    
                                            Name = ADName                    
                                    FROM    dbo.ADMaster                    
                                    WHERE   FreezeStatus = 0                    
                                    ORDER BY 1;                    
                                END;                    
                            ELSE                    
                                IF ( @option = 'GetTM' )                    
                                    BEGIN                    
                                        SELECT DISTINCT                    
                                                GUR.GlobalUserID AS ID,                    
                                                LM.EmployeeName AS Name                    
                                        FROM    LoginMaster LM                    
                                                JOIN EmeraldHierarchies_MVC.dbo.GlobalUserRoles GUR ON GUR.GlobalUserID = LM.GlobalUserID                    
                                                          AND YEAR(EndDate) = 2099                    
                                                JOIN EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers HRGU ON HRGU.GlobalUserID = GUR.GlobalUserID                    
                                                              AND RoleLeaveDate IS NULL              
                                                JOIN EmeraldHierarchies_MVC.dbo.GlobalUserProjects GUP ON GUP.GlobalUserID = LM.GlobalUserID                    
                                                              AND GUP.FreezeStatus = 0                    
                                               JOIN EmeraldHierarchies_MVC.dbo.Projects P ON P.ProjectID = GUP.ProjectID                    
         -- AND HRGU.HRSystemSourcesID = 17                    
                                        WHERE   LM.FreezeStatus = 0                    
                                               -- AND GUR.ParentGlobalUserID IS NOT NULL  -- updated For ALG                    
                                                AND LM.AccessLMID IN ( 1, 6 ) AND (CASE @option1 WHEN 5 THEN @option2 ELSE LM.GlobalUserID end)=@option2                    
            --AND (LM.glo in (CASE WHEN  @option1='' THEN 1 ELSE @option1 end)                    
                                                AND P.ClientID IN ( @option3 )                    
                                        ORDER BY LM.EmployeeName;                      
                                    END;                    
                                ELSE                    
                                    IF @option = 'WAT_WorkGroups'                    
                                        BEGIN                    
                                            IF CAST(@option2 AS INT) IN ( 5 )                    
                                                BEGIN                                
                                                    SELECT  DISTINCT                    
                                                            CAST(WGM.WorkGMID AS VARCHAR)                    
                                                            + '~'                    
                                                            + CAST(C.CampaignID AS VARCHAR) AS [WorkGMID] ,                    
                    WGM.WorkGroupName AS [WorkGroupName] ,                    
                                                            ID = WGM.WorkGMID ,                   
                                                            Name = WGM.WorkGroupName                    
                                                FROM    dbo.WAT_WorkGroupMaster WGM                    
                                                            JOIN dbo.WAT_WorkGroupCampaignDetail WGCD ON WGCD.WorkGMID = WGM.WorkGMID                    
       AND WGCD.FreezeStatus = 0                    
                   JOIN EmeraldHierarchies_MVC.dbo.Campaigns C ON C.CampaignID = WGCD.CampaignID                    
                                                              AND C.ProjectID IS NOT NULL                    
                                                    WHERE   WGM.FreezeStatus = 0                    
                                                    ORDER BY 2;                        
                                                END;                      
                                            ELSE                    
                                                IF CAST(@option2 AS INT) IN (                    
                                                    4, 6 )                    
                                                    BEGIN                                
                                                        SELECT  DISTINCT                    
                                                              CAST(WGM.WorkGMID AS VARCHAR)                    
                                                              + '~'                    
                                                              + CAST(C.CampaignID AS VARCHAR) AS [WorkGMID] ,                    
                                                              WGM.WorkGroupName AS [WorkGroupName] ,                    
                                                              ID = WGM.WorkGMID ,                    
                                                              Name = WGM.WorkGroupName                    
                                                        FROM  dbo.WAT_WorkGroupMaster WGM                    
   JOIN dbo.WAT_WorkGroupCampaignDetail WGCD ON WGCD.WorkGMID = WGM.WorkGMID                    
   AND WGCD.FreezeStatus = 0                    
                                                         JOIN EmeraldHierarchies_MVC.dbo.Campaigns C ON C.CampaignID = WGCD.CampaignID                    
                                                              AND C.ProjectID IS NOT NULL                    
                                                        WHERE WGM.FreezeStatus = 0                    
                                                              AND WGM.ClientID IN (                    
                                                              SELECT                    
                                                              ClientID                    
                                                              FROM                    
                                                              dbo.ClientLoginMappingDetail                    
                                                              WHERE                    
                                                              [STATUS] = 0                    
                                                              AND ( LoginMID = @option1                    
                                                              OR GlobalUserID = @option1                    
                                                              ) )                    
                                                        ORDER BY 2;                        
                                                    END;                        
                                                ELSE                    
                                                    IF CAST(@option2 AS INT) < 4                    
                                                        BEGIN                                
                                                            SELECT  DISTINCT                    
                                                              CAST(WGM.WorkGMID AS VARCHAR)               
 + '~'                    
+ CAST(WGCD.CampaignID AS VARCHAR) AS [WorkGMID] ,                    
                                                              WGM.WorkGroupName AS [WorkGroupName] ,                    
                                         ID = WGM.WorkGMID ,                    
                                                              Name = WGM.WorkGroupName                    
                           FROM                    
                                                              dbo.WAT_WorkGroupMaster WGM                    
                                                              JOIN dbo.WAT_WorkGroupCampaignDetail WGCD ON WGCD.WorkGMID = WGM.WorkGMID                    
                                                              AND WGCD.FreezeStatus = 0                    
                                                 WHERE                    
                                                              WGM.FreezeStatus = 0                    
                                                              AND WGM.ClientID IN (                    
                                                              SELECT                    
                                                              ClientID                    
                                                              FROM                    
                                                              dbo.ClientLoginMappingDetail                    
                                                              WHERE                    
                                                              [STATUS] = 0                    
                                                              AND LoginMID = @option1 )                    
                                                            ORDER BY 2;                    
                                                        END;                                
                                                    ELSE                    
                                         IF ( CAST(@option2 AS INT) IN (               
                              16, 7,13,9 ) )                    
                                                            BEGIN                                
                                                              SELECT  DISTINCT                    
                                                              CAST(WGM.WorkGMID AS VARCHAR)                    
                                                              + '~'                    
                                                              + CAST(WGCD.CampaignID AS VARCHAR) AS [WorkGMID] ,                    
                                                              WGM.WorkGroupName AS [WorkGroupName] ,                    
                                                              ID = WGM.WorkGMID ,                    
                                                              Name = WGM.WorkGroupName                    
                                                              FROM                    
                                                              dbo.WAT_WorkGroupMaster WGM                    
                                                              JOIN dbo.WAT_WorkGroupCampaignDetail WGCD ON WGCD.WorkGMID = WGM.WorkGMID                    
                                                              AND WGCD.FreezeStatus = 0                    
                                                              JOIN EmeraldHierarchies_MVC.dbo.Campaigns C ON C.CampaignID = WGCD.CampaignID                    
                                                              AND C.ProjectID IS NOT NULL                    
                                                              JOIN dbo.WAT_WorkGroupAgentDetail WGAD ON WGAD.WorkGMID = WGM.WorkGMID                    
                                                              AND WGAD.LoginMID = @option1                    
                       WHERE                    
                                                              WGM.FreezeStatus = 0                    
                                                           AND WGM.ClientID IN (                    
                                                              SELECT                    
                        ClientID                    
                                                              FROM                    
                           dbo.ClientLoginMappingDetail                    
                                                              WHERE                    
                                                              [STATUS] = 0                    
                                                              AND LoginMID = @option1 )                    
                                 ORDER BY 2;                        
                                                            END;                        
          END;                    
                
                
                
     IF @option = 'WAT_WorkGroups_EasyJet'                    
                                        BEGIN                    
                                          IF ( CAST(@option2 AS INT) IN (                    
                                                             16, 7,13,9 ) )                    
                                                            BEGIN                                
                                                              SELECT  DISTINCT                    
                                                              CAST(WGM.WorkGMID AS VARCHAR)                    
                                                              + '~'                    
                                                              + CAST(WGCD.CampaignID AS VARCHAR) AS [WorkGMID] ,                    
                                                              WGM.WorkGroupName AS [WorkGroupName] ,                    
                                                              ID = WGM.WorkGMID ,                    
                                                              Name = WGM.WorkGroupName           
                                                              FROM                    
      dbo.WAT_WorkGroupMaster WGM                    
                                                              JOIN dbo.WAT_WorkGroupCampaignDetail WGCD ON WGCD.WorkGMID = WGM.WorkGMID                    
                                                              AND WGCD.FreezeStatus = 0                    
                                                              JOIN EmeraldHierarchies_MVC.dbo.Campaigns C ON C.CampaignID = WGCD.CampaignID                    
                                                              AND C.ProjectID IS NOT NULL                    
                                                              JOIN dbo.WAT_WorkGroupAgentDetail WGAD ON WGAD.WorkGMID = WGM.WorkGMID                    
                                                              AND WGAD.LoginMID = @option1                  
                                                              --JOIN dbo.WAT_WorkgorupQueueMapping WGQM ON WGQM.WorkGMID = WGM.WorkGMID                    
                                                              WHERE                    
                                                              WGM.FreezeStatus = 0                    
                                                              AND WGM.ClientID IN (                    
                                                              SELECT                    
                                                              ClientID                    
                                                              FROM                    
                                                              dbo.ClientLoginMappingDetail                    
                                                              WHERE                    
                                            [STATUS] = 0                    
                                                              AND LoginMID = @option1 )                    
                                 ORDER BY 2;                        
                                                            END;                             
END                
                
                
                
                
                
                
                
                
                      ELSE                    
                         IF @option = 'WAT_WorkDivisions'                    
                                            BEGIN                    
                                                IF @option1 = ''                    
                      BEGIN                                  
                                                        SELECT                    
                                                              WorkDMID ,                    
                                        WorkDivisionName                    
                                                        FROM  dbo.WAT_WorkDivisionMaster                    
             WHERE FreezeStatus = 0                    
                                                        ORDER BY WorkDivisionName;                     
                                                    END;                                  
                                                ELSE                    
                                                    BEGIN                                  
                                                        SELECT  DISTINCT                    
                                                              WDM.WorkDMID ,                    
                                                              WDM.WorkDivisionName                    
     FROM  dbo.WAT_WorkDivisionMaster WDM                    
                                                              JOIN WAT_WorkGroupWorkDivisionDetail WGWD ON WGWD.WorkDMID = WDM.WorkDMID                    
                                                              AND WGWD.FreezeStatus = 0                    
                                                        WHERE WDM.FreezeStatus = 0                    
                                                              AND WGWD.WorkGMID = @option1                    
               ORDER BY WorkDivisionName;                     
                                                    END;                                  
                PRINT ( @strsql );                                  
                                                EXEC (@strsql);                                  
                                            END;                                  
                                        ELSE                    
                                            IF @option = 'WAT_WorkItems'                    
                                                BEGIN                                  
                                                    IF @option1 = ''                    
                                                        BEGIN                                  
                         SELECT                    
                                                              WorkIMID ,                    
                                                              WorkItemName                    
                                                            FROM                    
                                                              dbo.WAT_WorkItemMaster                    
                                                            WHERE                    
                                                              FreezeStatus = 0                    
                                                            ORDER BY WorkItemName;                     
                                                        END;                                  
                                               ELSE                    
                                                        BEGIN                                  
                                                            SELECT  DISTINCT                    
                                                              WIM.WorkIMID ,                    
                                                              WIM.WorkItemName                    
                                                            FROM                    
                                         dbo.WAT_WorkItemMaster WIM                    
                                                              JOIN WAT_WorkDivisionWorkItemDetail WDWI ON WDWI.WorkIMID = WIM.WorkIMID                    
                                                              AND WDWI.FreezeStatus = 0                    
                                           WHERE                    
   WIM.FreezeStatus = 0                    
                                                              AND WDWI.WorkDMID = @option1                    
             ORDER BY WIM.WorkItemName;                    
                                                        END;                                  
                                                    PRINT ( @strsql );                                  
                                                    EXEC (@strsql);                                  
                                                END;                    
                                            ELSE                    
                                                IF @option = 'WAT_Campaign'                    
                                                  BEGIN                    
                                                        IF CAST(@option2 AS INT) IN (                    
                                                            5 )                    
                                                            BEGIN                                
                                                              SELECT  DISTINCT                    
                                                              ID = C.CampaignID ,                    
                                                              Name = C.CampaignName                    
       FROM                    
                                                              dbo.WAT_WorkGroupMaster WGM                    
                                                              JOIN dbo.WAT_WorkGroupCampaignDetail WGCD ON WGCD.WorkGMID = WGM.WorkGMID                    
                                                              AND WGCD.FreezeStatus = 0                    
           JOIN EmeraldHierarchies_MVC.dbo.Campaigns C ON C.CampaignID = WGCD.CampaignID                    
                                                              AND C.ProjectID IS NOT NULL                    
                                                            WHERE                    
                                                              WGM.FreezeStatus = 0                    
                                                              ORDER BY 2;                    
                                                            END;                      
                                                        ELSE                    
                                                            IF CAST(@option2 AS INT) IN (                    
                                                              4, 6, 7 )                    
                                                    BEGIN                                
                                                              SELECT  DISTINCT                    
                                                              ID = C.CampaignID ,                    
                                                              Name = C.CampaignName                    
                                                              FROM                    
                                                              dbo.WAT_WorkGroupMaster WGM                    
                                                              JOIN dbo.WAT_WorkGroupCampaignDetail WGCD ON WGCD.WorkGMID = WGM.WorkGMID                    
                                                              AND WGCD.FreezeStatus = 0                    
                                                              JOIN EmeraldHierarchies_MVC.dbo.Campaigns C ON C.CampaignID = WGCD.CampaignID                    
                                                              AND C.ProjectID IS NOT NULL         
                                                              WHERE                    
                                                              WGM.FreezeStatus = 0                    
                                                              AND WGM.ClientID IN (                    
                                                              SELECT                    
                                                              ClientID                    
                                                              FROM                    
                                                              dbo.ClientLoginMappingDetail                    
                                           WHERE                    
                                                              [STATUS] = 0                    
                 AND GlobalUserID = @option1 )                    
   ORDER BY 2;                    
                     END;                        
     ELSE                    
                                                              IF CAST(@option2 AS INT) < 4                
                                BEGIN                                
                                                              SELECT  DISTINCT                    
                                                              ID = C.CampaignID ,                    
                                                              Name = C.CampaignName                    
                                                       FROM                    
                                                              dbo.WAT_WorkGroupMaster WGM                    
                                                    JOIN dbo.WAT_WorkGroupCampaignDetail WGCD ON WGCD.WorkGMID = WGM.WorkGMID                   
                                                              AND WGCD.FreezeStatus = 0                    
                                                              JOIN EmeraldHierarchies_MVC.dbo.Campaigns C ON C.CampaignID = WGCD.CampaignID                    
                                                              AND C.ProjectID IS NOT NULL                    
                                                              WHERE                    
                                                              WGM.FreezeStatus = 0            
                                                              AND WGM.ClientID IN (                    
                                                              SELECT                    
                                                              ClientID                    
                                                              FROM                    
                                                              dbo.ClientLoginMappingDetail                    
                                                              WHERE                    
                        [STATUS] = 0                    
                                                              AND GlobalUserID = @option1 )                    
                                                              ORDER BY 2;                    
                                                              END;                    
                                                              ELSE                    
             IF CAST(@option2 AS INT) = 16                    
                                                       BEGIN                                
                                                              SELECT  DISTINCT                    
                                                              ID = C.CampaignID ,                    
                                                              Name = C.CampaignName                    
                                                              FROM                    
                                                              dbo.WAT_WorkGroupMaster WGM                    
                                                              JOIN dbo.WAT_WorkGroupCampaignDetail WGCD ON WGCD.WorkGMID = WGM.WorkGMID                    
                                                              AND WGCD.FreezeStatus = 0                    
                                                              JOIN EmeraldHierarchies_MVC.dbo.Campaigns C ON C.CampaignID = WGCD.CampaignID                    
                                                              AND C.ProjectID IS NOT NULL                    
                                                              JOIN dbo.WAT_WorkGroupAgentDetail WGAD ON WGAD.WorkGMID = WGM.WorkGMID                    
                                                              AND WGAD.GlobalUserID = @option1                    
                                                              WHERE                    
                                                              WGM.FreezeStatus = 0                    
                                                              AND WGM.ClientID IN (          
                                                              SELECT                    
                                                              ClientID                    
               FROM                    
                                                              dbo.ClientLoginMappingDetail                    
                                                              WHERE                    
   [STATUS] = 0                    
                                              AND GlobalUserID = @option1 )                    
                       ORDER BY 2;                    
                                                          END;                        
                                                    END;                    
        IF @option = 'TMForBOCanvas'                    
            BEGIN                    
     IF @option2 = 5                    
                    BEGIN                    
                        SELECT DISTINCT                    
                            GU.FirstName + ' ' + GU.LastName AS [EmployeeName] ,                    
                                GU.GlobalUserID ,                    
                                ID = GU.GlobalUserID ,                    
                                Name = GU.FirstName + ' ' + GU.LastName                    
                        FROM    EmeraldHierarchies_MVC.dbo.GlobalUsers GU                    
                                JOIN EmeraldHierarchies_MVC.dbo.GlobalUserRoles GUR ON GUR.ParentGlobalUserID = GU.GlobalUserID                    
     AND YEAR(GUR.EndDate) = 2099                    
                                JOIN EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers HRGU ON HRGU.GlobalUserID = GU.GlobalUserID                    
                                                              AND HRGU.RoleLeaveDate IS NULL                    
                        WHERE   GUR.GlobalUserID IN (                    
                                SELECT  ISNULL(GlobalUserID, 0)                    
                                FROM    dbo.LoginMaster                    
                                WHERE   ISNULL(ActivityTrackerAccess, 0) = 1 )                    
                        ORDER BY 1;                    
                    END;                    
                ELSE                    
                    IF @option2 = 2                    
                BEGIN                    
                            SELECT DISTINCT                    
                                    GU.FirstName + ' ' + GU.LastName AS [EmployeeName] ,                    
                                    GU.GlobalUserID ,                    
                                    ID = GU.GlobalUserID ,                    
                                    Name = GU.FirstName + ' ' + GU.LastName                    
                            FROM    EmeraldHierarchies_MVC.dbo.GlobalUsers GU                    
                                    JOIN EmeraldHierarchies_MVC.dbo.GlobalUserRoles GUR ON GUR.GlobalUserID = GU.GlobalUserID                    
                                                              AND YEAR(GUR.EndDate) = 2099                    
                                    JOIN EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers HRGU ON HRGU.GlobalUserID = GU.GlobalUserID                    
    AND HRGU.RoleLeaveDate IS NULL                    
                            WHERE   GUR.ParentGlobalUserID = @option1                    
                            ORDER BY 1;                    
                        END;                    
                    ELSE                    
                        BEGIN                    
                            SELECT DISTINCT                    
                                    GU.FirstName + ' ' + GU.LastName AS [EmployeeName] ,                    
                                    GU.GlobalUserID ,                    
     ID = GU.GlobalUserID ,                    
                                    Name = GU.FirstName + ' ' + GU.LastName                    
                            FROM    EmeraldHierarchies_MVC.dbo.GlobalUsers GU                    
                                    JOIN EmeraldHierarchies_MVC.dbo.GlobalUserRoles GUR ON GUR.ParentGlobalUserID = GU.GlobalUserID                    
                           AND YEAR(GUR.EndDate) = 2099                    
                                    JOIN EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers HRGU ON HRGU.GlobalUserID = GU.GlobalUserID                    
                                                              AND HRGU.RoleLeaveDate IS NULL                    
                            WHERE   GUR.GlobalUserID IN (                    
                                    SELECT  ISNULL(GlobalUserID, 0)                    
                                    FROM    dbo.LoginMaster                    
                                    WHERE   ISNULL(ActivityTrackerAccess, 0) = 1 )                    
                                    AND HRGU.ClientID IN (                    
                       SELECT  CAST(ClientID AS VARCHAR)                    
             FROM    dbo.ClientLoginMappingDetail                    
          WHERE   GlobalUserID = @option1 )                    
                    ORDER BY 1;                    
                        END;                    
            END;                    
        IF @option = 'WAT_OutcomeByWorkItemID'                    
            BEGIN                                      
  IF @option3 = ''                    
                    BEGIN                                      
                        SET @strsql = 'SELECT  OutcomeMID ,                    
            Outcome                    
          FROM    dbo.WAT_OutcomeMaster                    
          WHERE   FreezeStatus = 0                    
          ORDER BY Outcome ';                                      
                    END;                                      
                ELSE                    
                    BEGIN                                      
                        SET @strsql = 'SELECT  DISTINCT                    
            OM.OutcomeMID ,                    
            OM.Outcome                    
          FROM    dbo.WAT_OutcomeMaster OM                    
            JOIN dbo.WAT_WorkItemOutcomeDetail WIOM ON WIOM.OutcomeMID = OM.OutcomeMID                    
          AND WIOM.FreezeStatus = 0                    
          WHERE   OM.FreezeStatus = 0                    
            AND WIOM.WorkIMID = '                    
                            + @option3 + '                    
          ORDER BY OM.Outcome ';                    
                    END;                                              
                PRINT ( @strsql );                                      
                EXEC (@strsql);                                     
            END;                    
        ELSE                    
            IF @option = 'WAT_CallOutcomesByWorkDMID'                    
                BEGIN                                      
                    IF @option1 = ''                    
                        BEGIN                    
                            SET @strsql = 'SELECT  OutcomeMID ,                    
             Outcome                    
           FROM    dbo.WAT_CallOutcomeMaster                    
           WHERE   FreezeStatus = 0                    
           ORDER BY Outcome ';                            END;                    
                    ELSE                    
                        BEGIN                                      
           SET @strsql = 'SELECT  DISTINCT                    
             OM.OutcomeMID ,                    
             OM.Outcome                    
           FROM    dbo.WAT_CallOutcomeMaster OM                    
             JOIN dbo.WAT_WorkDivisionCallOutcomeDetail WDOM ON WDOM.OutcomeMID = OM.OutcomeMID                    
                          AND WDOM.FreezeStatus = 0                    
           WHERE   OM.FreezeStatus = 0                    
             AND WDOM.WorkDMID = '                    
                                + @option1 + '                    
           ORDER BY OM.Outcome ';                                      
                        END;                    
                    PRINT ( @strsql );                    
                    EXEC (@strsql);                    
                END;                     
            ELSE                    
                IF ( @option = 'BackOfficeAgent' )                    
                    BEGIN                    
                        IF ( @option2 = 1 )                    
                            BEGIN                                
                                SET @strsql = 'SELECT  GU.FirstName + '' '' + GU.LastName AS Name ,                    
                       GU.GlobalUserID ,                    
                       LM.LoginMID AS ID                    
                     FROM    EmeraldHierarchies_MVC.dbo.GlobalUsers GU                    
                       JOIN LoginMaster LM ON LM.GlobalUserID = GU.GlobalUserID                    
                    AND FreezeStatus = 0                    
                               AND LM.AccessLMID in (16,7)                    
                     WHERE   GU.GlobalUserID IN ( SELECT GlobalUserID                    
                             FROM   EmeraldHierarchies_MVC.dbo.GlobalUserRoles                    
                             WHERE  ParentGlobalUserID IN ( '                    
                                    + @option1                    
                                    + ' )                    
                              AND GlobalUserRoleTypeID = 5 AND FreezeDate IS NULL )                    
                     ORDER BY 1';                                
                                PRINT ( @strsql );                    
                                EXEC (@strsql);                    
                            END;                    
                        ELSE                    
                            IF ( @option2 = 2 )                    
                                BEGIN                    
                                    SET @strsql = 'SELECT  GU.FirstName + '' '' + GU.LastName AS Name ,                   
                       GU.GlobalUserID ,                    
                       LM.LoginMID AS ID                    
                     FROM EmeraldHierarchies_MVC.dbo.GlobalUsers GU                    
                       JOIN LoginMaster LM ON LM.GlobalUserID = GU.GlobalUserID                    
                               AND FreezeStatus = 0                    
                               AND LM.AccessLMID = 16                    
                     WHERE   GU.GlobalUserID IN (                    
                       SELECT  GlobalUserID                    
                       FROM    EmeraldHierarchies_MVC.dbo.GlobalUserRoles                    
                       WHERE   ParentGlobalUserID IN (                    
                         SELECT  GlobalUserID                    
                         FROM    EmeraldHierarchies_MVC.dbo.GlobalUserRoles                    
                         WHERE   ParentGlobalUserID IN ( '' + @option1 + '' ) )                    
                         AND GlobalUserRoleTypeID = 5 )                    
                     ORDER BY 1';                                
                                    PRINT ( @strsql );                                
                                    EXEC (@strsql);                            
                                END;                    
                            ELSE                    
                                IF ( @option2 >= 4 )                    
                    BEGIN                                
  SET @strsql = 'SELECT  GU.FirstName + '' '' + GU.LastName AS Name ,                    
                       GU.GlobalUserID ,                    
                       LM.LoginMID AS ID                    
                     FROM    EmeraldHierarchies_MVC.dbo.GlobalUsers GU                    
                       JOIN LoginMaster LM ON LM.GlobalUserID = GU.GlobalUserID                    
                               AND FreezeStatus = 0                    
                               AND LM.AccessLMID = 16                    
                     ORDER BY 1';                    
                           PRINT ( @strsql );                                
                                        EXEC (@strsql);                            
                                    END;                    
                    END;                    
        IF ( @option = 'MenuLevel' )                    
            BEGIN                    
                IF @option3 = '1'                    
                    BEGIN                    
                        SELECT  MenuMDID AS ID ,                    
                                MenuName AS Name                    
                        FROM    dbo.MenuMasterDetail                    
                        WHERE   MenuLevel = @option1                    
                                AND PageName = '#'                    
                                AND MenuParentID = @option2                    
                            AND FreezeStatus = 0                    
                        ORDER BY 2;                    
     END;                    
                ELSE                    
                    BEGIN                    
                        SELECT  ClientReportMID AS ID ,                    
                                ClientReportName AS Name                    
                        FROM    dbo.ClientReportMaster                    
                        WHERE   ReportLevel = @option1                    
                                AND ClientReportPage = '#'                    
                                AND ParentClientReportMID = @option2                    
                                AND FreezeStatus = 0                    
                        ORDER BY 2;                    
                    END;                    
            END;                    
        ELSE                    
            IF ( @option = 'QMSReportType' )                    
                BEGIN                    
                    SELECT  ReportTypeID AS ID ,                    
                            ReportType AS Name                    
                    FROM    dbo.QMSReportTypeMaster                    
                    WHERE   FreezeStatus = 0                    
                    ORDER BY 2;                    
                END;                    
            ELSE                    
              IF ( @option = 'BIReportType' )                    
                    BEGIN                    
                        SELECT  ReportTypeID AS ID ,                    
                                ReportType AS Name                    
                        FROM    dbo.BIReportTypeMaster                    
                        WHERE   FreezeStatus = 0                    
                        ORDER BY 2;                    
                    END;                    
                ELSE                    
                    IF ( @option = 'ClientsForMenu' )                    
                BEGIN                    
                            SELECT  ClientID AS ID ,                    
                                  ClientName AS Name                    
                            FROM    EmeraldHierarchies_MVC.dbo.Clients                    
                            WHERE   IsActive = 1                    
                            ORDER BY 2;                    
          END;                    
                    ELSE                    
                        IF ( @option = 'AccessLevelForMenu' )                    
             BEGIN                    
           SELECT  AccessLMID AS ID ,                    
                                        Accesslevel AS Name                    
                                FROM    dbo.AccessLevelMaster                    
                                WHERE   FreezeStatus = 0                  
                                ORDER BY 1;                    
                            END;                    
                        ELSE                    
                            IF ( @option = 'DashboardByClient' )                    
                                BEGIN                    
                                    SELECT  ISNULL(BI, 0) AS [BI] ,                    
                                            ISNULL(QMS, 0) AS [QMS]                    
                                    FROM    EmeraldHierarchies_MVC.dbo.Clients                    
                                    WHERE   ClientID = @option1;                    
                       END;                    
                    
        IF ( @option = 'MDAccount' )                    
            BEGIN                    
                IF @option2 IN ( 5, 13 )                    
                    BEGIN                    
                        SELECT  DISTINCT                    
                                CL.ClientID AS ID ,                    
                                CL.ClientName AS Name                    
                        FROM    EmeraldHierarchies_MVC.dbo.Clients CL                    
                        WHERE   CL.IsActive = 1                    
                        ORDER BY 2;                 
                    END;                    
                ELSE                    
                    BEGIN                    
                        SELECT DISTINCT                    
                      CL.ClientID AS ID ,                    
                                CL.ClientName AS Name                    
                        FROM    EmeraldHierarchies_MVC.dbo.Clients CL                    
                                JOIN dbo.ClientLoginMappingDetail CLMD ON CLMD.ClientID = CL.ClientID                    
       AND CLMD.STATUS = 0                    
                        WHERE   CL.IsActive = 1                    
                                AND CLMD.LoginMID = @option1                    
                        ORDER BY 2;                    
                    END;                    
            END;                    
        ELSE                    
            IF ( @option = 'MDRM' )                    
                BEGIN                    
                    IF @option3 <> ''                    
                        BEGIN                    
                            IF @option2 IN ( 5, 13 )                    
                                BEGIN                    
                                    SELECT DISTINCT                    
                                            GRMM.RMMID AS ID ,                    
                                            GRMM.RMName AS Name                    
                                    FROM    EmeraldHierarchies_MVC.dbo.MD_GlobalRMMaster GRMM                    
                                            JOIN EmeraldHierarchies_MVC.dbo.MD_ClientRMMappingMaster RMM ON RMM.RMMID = GRMM.RMMID               
                                                              AND RMM.FreezeStatus = 0                    
                                            JOIN EmeraldHierarchies_MVC.dbo.Clients CL ON CL.ClientID = RMM.ClientID                    
                                                              AND CL.IsActive = 1                    
                                    WHERE   GRMM.FreezeStatus = 0                    
              AND CL.ClientID = @option3                    
                                    ORDER BY 2;                    
                                END;                    
                            ELSE                    
                                BEGIN                    
                                    SELECT DISTINCT                    
                                            GRMM.RMMID AS ID ,                    
                                            GRMM.RMName AS Name                    
                                    FROM    EmeraldHierarchies_MVC.dbo.MD_GlobalRMMaster GRMM                    
                                            JOIN EmeraldHierarchies_MVC.dbo.MD_ClientRMMappingMaster RMM ON RMM.RMMID = GRMM.RMMID                    
             AND RMM.FreezeStatus = 0                    
                                            JOIN EmeraldHierarchies_MVC.dbo.Clients CL ON CL.ClientID = RMM.ClientID                    
                                                           AND CL.IsActive = 1                    
              JOIN dbo.ClientLoginMappingDetail CLMD ON CLMD.ClientID = CL.ClientID                    
             AND CLMD.STATUS = 0                    
                                    WHERE   GRMM.FreezeStatus = 0                    
                                            AND CL.ClientID = @option3                    
                                            AND CLMD.LoginMID = @option1                    
                                    ORDER BY 2;                    
                                END;                    
                        END;                    
                    ELSE                    
                        BEGIN                    
                            IF @option2 IN ( 5, 13 )                    
                                BEGIN                    
                                    SELECT DISTINCT                    
                                            GRMM.RMMID AS ID ,              
                                            GRMM.RMName AS Name                    
                                    FROM    EmeraldHierarchies_MVC.dbo.MD_GlobalRMMaster GRMM                    
                                            JOIN EmeraldHierarchies_MVC.dbo.MD_ClientRMMappingMaster RMM ON RMM.RMMID = GRMM.RMMID                    
                                                              AND RMM.FreezeStatus = 0                    
                                            JOIN EmeraldHierarchies_MVC.dbo.Clients CL ON CL.ClientID = RMM.ClientID                    
                                                              AND CL.IsActive = 1                    
                                            JOIN dbo.ClientLoginMappingDetail CLMD ON CLMD.ClientID = CL.ClientID                    
                                                              AND CLMD.STATUS = 0                    
              WHERE   GRMM.FreezeStatus = 0                    
                                            AND CLMD.LoginMID = @option1                    
                                    ORDER BY 2;                    
                                END;                    
                            ELSE                    
                                BEGIN                           
                                    SELECT DISTINCT                    
                                            GRMM.RMMID AS ID ,                    
                                            GRMM.RMName AS Name                    
                                    FROM    EmeraldHierarchies_MVC.dbo.MD_GlobalRMMaster GRMM                    
                                            JOIN EmeraldHierarchies_MVC.dbo.MD_ClientRMMappingMaster RMM ON RMM.RMMID = GRMM.RMMID                                                                          AND RMM.FreezeStatus = 0                    
  JOIN EmeraldHierarchies_MVC.dbo.Clients CL ON CL.ClientID = RMM.ClientID                    
                                                              AND CL.IsActive = 1                    
                                            JOIN dbo.ClientLoginMappingDetail CLMD ON CLMD.ClientID = CL.ClientID                    
                                                              AND CLMD.STATUS = 0                    
                                    WHERE   GRMM.FreezeStatus = 0                    
                                            AND CLMD.LoginMID = @option1                    
                                    ORDER BY 2;                    
                                END;                    
                        END;                    
                END;                    
            ELSE                    
                IF ( @option = 'MDRegion' )                    
                    BEGIN                    
                        IF @option3 <> ''                    
                            BEGIN             
                                IF @option2 IN ( 5, 13 )                    
                                    BEGIN                    
                                        SELECT DISTINCT                    
     ID = RM.RegionMID ,                    
                                                Name = RM.RegionName                    
                                        FROM    EmeraldHierarchies_MVC.dbo.MD_RegionMaster RM                    
                                                JOIN EmeraldHierarchies_MVC.dbo.MD_ClientRegionMappingMaster CRMM ON CRMM.RegionMID = RM.RegionMID                    
                                                              AND CRMM.FreezeStatus = 0                    
                                       WHERE   RM.FreezeStatus = 0                    
     AND CRMM.ClientID = @option3                    
ORDER BY 2;                    
                                    END;                    
                                ELSE                    
                                    BEGIN                    
                                  SELECT DISTINCT          
                                                ID = RM.RegionMID ,                    
                                                Name = RM.RegionName                    
                                        FROM    EmeraldHierarchies_MVC.dbo.MD_RegionMaster RM                    
                                                JOIN EmeraldHierarchies_MVC.dbo.MD_ClientRegionMappingMaster CRMM ON CRMM.RegionMID = RM.RegionMID                    
                                                              AND CRMM.FreezeStatus = 0                    
                                                JOIN dbo.ClientLoginMappingDetail CLMD ON CLMD.ClientID = CRMM.ClientID                    
                                                              AND CLMD.STATUS = 0                    
                                        WHERE   RM.FreezeStatus = 0                    
                                                AND CRMM.ClientID = @option3                    
                                                AND CLMD.LoginMID = @option1                    
     ORDER BY 2;                    
      END;                    
                            END;                    
                        ELSE                    
                            BEGIN                    
                                IF @option2 IN ( 5, 13 )                    
                                    BEGIN                    
                                        SELECT DISTINCT                                                    ID = RM.RegionMID ,                    
                                                Name = RM.RegionName                    
                                        FROM    EmeraldHierarchies_MVC.dbo.MD_RegionMaster RM                    
                                   JOIN EmeraldHierarchies_MVC.dbo.MD_ClientRegionMappingMaster CRMM ON CRMM.RegionMID = RM.RegionMID                    
                                                              AND CRMM.FreezeStatus = 0           
                                        WHERE   RM.FreezeStatus = 0                    
                                        ORDER BY 2;                    
                                    END;                    
                                ELSE                    
                                    BEGIN                    
                                        SELECT DISTINCT                    
                                                ID = RM.RegionMID ,                    
                                                Name = RM.RegionName                    
                                        FROM    EmeraldHierarchies_MVC.dbo.MD_RegionMaster RM                    
                                                JOIN EmeraldHierarchies_MVC.dbo.MD_ClientRegionMappingMaster CRMM ON CRMM.RegionMID = RM.RegionMID                    
                                                              AND CRMM.FreezeStatus = 0                    
                                                JOIN dbo.ClientLoginMappingDetail CLMD ON CLMD.ClientID = CRMM.ClientID                    
                                                              AND CLMD.STATUS = 0                    
                                        WHERE   RM.FreezeStatus = 0                    
                                                AND CLMD.LoginMID = @option1                    
                                        ORDER BY 2;                    
                                    END;                    
                            END;                    
                    END;                    
                ELSE                    
                    IF ( @option = 'MDCurrency' )                    
    BEGIN                    
                            IF @option2 IN ( 5, 12 )                    
                                BEGIN                    
                                    SELECT  CAST(CM.CurrencyMID AS VARCHAR(50))                    
                   + '~'                    
                                            + CAST(CM.ConversionRate AS VARCHAR(50)) AS ID ,                    
                                           CM.CurrencyName AS Name                    
                                    FROM    EmeraldHierarchies_MVC.dbo.MD_CurrencyMaster CM                    
         WHERE   CM.FreezeStatus = 0                    
                                    ORDER BY 2;                    
                                END;                    
       ELSE                    
                BEGIN                    
                        SELECT  CAST(CM.CurrencyMID AS VARCHAR(50))                    
                                            + '~'                    
                                            + CAST(CM.ConversionRate AS VARCHAR(50)) AS ID ,                    
                                            CM.CurrencyName AS Name                    
                                    FROM    EmeraldHierarchies_MVC.dbo.MD_CurrencyMaster CM                    
                                    WHERE   CM.FreezeStatus = 0                    
                                    ORDER BY 2;                    
                                END;                    
                        END;                    
                    ELSE                    
                        IF ( @option = 'MDColor' )                    
                            BEGIN                    
                                IF @option2 IN ( 5, 13 )                    
                                    BEGIN                    
      SELECT  CM.ColorsMID AS ID ,                    
                                                CM.Color AS Name     
                                        FROM    EmeraldHierarchies_MVC.dbo.MD_ColorsMaster CM                    
                                        WHERE   CM.FreezeStatus = 0                    
                                        ORDER BY 2;                    
                                    END;                    
                                ELSE                    
                             BEGIN                    
                                        SELECT  CM.ColorsMID AS ID ,                    
                                                CM.Color AS Name                    
               FROM    EmeraldHierarchies_MVC.dbo.MD_ColorsMaster CM                    
                         WHERE   CM.FreezeStatus = 0                    
                                        ORDER BY 2;                    
                                    END;                    
                            END;                    
                        ELSE                    
                            IF ( @option = 'MDAccountType' )                    
                                BEGIN                    
                                    SELECT  ID = AccountTypeMID ,                    
                                            Name = AccountType                    
                                    FROM    EmeraldHierarchies_MVC.dbo.MD_AccountTypeMaster ATM                    
                                    WHERE   FreezeStatus = 0                    
                                    ORDER BY 2;                    
                                END;                    
                            ELSE                    
   IF ( @option = 'MDWeeks' )                    
                                    BEGIN                    
                                        SELECT DISTINCT                    
                                                ID = CONVERT(VARCHAR(10), WeekStartDate_MI, 121) ,                    
                                                Name = CONVERT(VARCHAR(10), WeekStartDate_MI, 103)                    
                                        FROM    dbo.WeekMaster                    
                                        WHERE   WeekNo_MI IS NOT NULL;                    
                                    END;                    
                                ELSE                    
                                    IF @option = 'AgentForWAT'  --Option1:AccessLMID,Option2:ClientIDs,Option3:GlobalUserID,Option4:GlobalUserids                    
                                        BEGIN                                                              DECLARE @noclientfilerAgentWAT VARCHAR(500)= '';                    
                                            DECLARE @parentstringAgentWAT VARCHAR(500)= '';                    
                                            DECLARE @parentstringAdminAgentWAT VARCHAR(500)= '';                    
                    
                                            IF @option4 = ''                    
                                                BEGIN                     
       SET @parentstringAgentWAT = ' AND gur.ParentGlobalUserID in ('                    
    + @option3 + ')';                          
                                                END;                    
                                            ELSE                    
                                                IF @option4 = '99999'                    
                                                    BEGIN                     
                                                        SET @parentstringAgentWAT = ' ';                    
                     END;                    
   ELSE                    
                                      BEGIN                    
                                                        SET @parentstringAgentWAT = ' AND gur.ParentGlobalUserID in ('                    
                + @option4 + ')';                    
                                                        SET @parentstringAdminAgentWAT = ' AND gur.ParentGlobalUserID in ('                    
                                                            + @option4 + ')';                    
                   END;                    
                    
                                            IF @option2 != ''                    
                                                SET @noclientfilerAgentWAT = 'c.ClientID in ('                    
                                                    + @option2 + ') AND ';                    
                          
                                            IF @option1 = '5'                    
                                                SET @strsql = 'SELECT DISTINCT Name=gu.FirstName + '' '' + gu.LastName,ID=LM.LoginMID                    
         FROM    EmeraldHierarchies_MVC.dbo.GlobalUsers gu                     
           inner join EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers HRGU on HRGU.GlobalUserID=gu.GlobalUserID and HRGU.RoleLeaveDate IS NULL                     
           INNER JOIN EmeraldHierarchies_MVC.dbo.Clients c ON cast(c.ClientID as varchar(50))=HRGU.ClientID                    
           INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUserRoles gur ON gur.GlobalUserID = gu.GlobalUserID and isnull(gur.freezestatus,0)=0                    
           INNER JOIN LoginMaster LM ON LM.GlobalUserID = GU.GlobalUserID AND LM.FreezeStatus = 0                    
         WHERE   ' + @noclientfilerAgentWAT                    
                                                    + ' gu.GlobalUserID NOT IN (                    
                        SELECT  GlobalUserID                    
                        FROM    Prism_Datamart_MVC.dbo.LoginMaster                    
                        WHERE   AccessLMID IN ( 5, 6 ) )                    
         AND gur.GlobalUserRoleTypeID = 5'                    
                                                    + @parentstringAdminAgentWAT;                    
                                            ELSE                    
                                                IF ( @option1 = '6' )                    
                                                    SET @strsql = 'SELECT DISTINCT Name=gu.FirstName + '' '' + gu.LastName,ID=LM.LoginMID                    
         FROM    EmeraldHierarchies_MVC.dbo.GlobalUsers gu                     
           inner join EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers HRGU on HRGU.GlobalUserID=gu.GlobalUserID and HRGU.RoleLeaveDate IS NULL                     
           INNER JOIN EmeraldHierarchies_MVC.dbo.Clients c ON cast(c.ClientID as varchar(50))=HRGU.ClientID                    
           INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUserRoles gur ON gur.GlobalUserID = gu.GlobalUserID  and isnull(gur.freezestatus,0)=0                    
           INNER JOIN LoginMaster LM ON LM.GlobalUserID = GU.GlobalUserID AND LM.FreezeStatus = 0                    
         WHERE   ' + @noclientfilerAgentWAT                    
                                                        + ' c.ClientID in (select distinct ClientID from ClientLoginMappingDetail where globaluserid='''                    
                                                  + @option3                    
                                  + ''' and [status]=0)                    
               and                    
                gu.GlobalUserID NOT IN (                    
                SELECT  GlobalUserID                    
                FROM    Prism_Datamart_MVC.dbo.LoginMaster                    
                WHERE   AccessLMID IN ( 5, 6 ) )                    
                AND gur.GlobalUserRoleTypeID = 5'                    
                                                        + @parentstringAdminAgentWAT;                    
                                                ELSE   
                                                    SET @strsql = 'SELECT DISTINCT  Name=gu.FirstName + '' '' + gu.LastName,ID=LM.LoginMID                    
         FROM EmeraldHierarchies_MVC.dbo.GlobalUsers gu                     
           inner join EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers HRGU on HRGU.GlobalUserID=gu.GlobalUserID and HRGU.RoleLeaveDate IS NULL                     
           INNER JOIN EmeraldHierarchies_MVC.dbo.Clients c ON cast(c.ClientID as varchar(50))=HRGU.ClientID                    
           INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUserRoles gur ON gur.GlobalUserID = gu.GlobalUserID and isnull(gur.freezestatus,0)=0                    
           INNER JOIN LoginMaster LM ON LM.GlobalUserID = GU.GlobalUserID AND LM.FreezeStatus = 0                    
         WHERE    ' + @noclientfilerAgentWAT                    
                                                        + ' c.ClientID in (select distinct ClientID from ClientLoginMappingDetail where globaluserid='''                    
                                                        + @option3                    
                                                        + ''' and [status]=0)                    
           AND gu.GlobalUserID NOT IN (                    
           SELECT  GlobalUserID                    
           FROM    Prism_Datamart_MVC.dbo.LoginMaster                 
           WHERE   AccessLMID IN ( 5, 6 ) )                    
           AND gur.GlobalUserRoleTypeID = 5'                    
                                                        + @parentstringAgentWAT;                    
                                
                                            PRINT ( @strsql );                    
                                            EXEC(@strsql);                        
                                        END;                    
                                    ELSE                    
                                        IF @option = 'WorkItem'--Option1:AccessLMID,Option2:GlobalUserID,Option3:WorkDivisonIDs                    
                                            BEGIN                                      
 SET @strsql = 'SELECT DISTINCT                    
          Name = WorkItemName ,                    
          ID = WIM.WorkIMID                    
        FROM    dbo.WAT_WorkItemMaster WIM                    
          JOIN dbo.WAT_WorkDivisionWorkItemDetail WDWI ON WIM.WorkIMID = WDWI.WorkIMID                    
        WHERE   WDWI.WorkDMID IN ( ' + @option3 + ')';                                
                                                PRINT ( @strsql );                                      
                                                EXEC (@strsql);                    
                                            END;                    
                                        ELSE                    
                  IF @option = 'WAT_HotelCode'                    
                                                BEGIN                                      
                                                    SELECT  HotelCodeMID AS [ID] ,                    
                                                            HotelCode AS [Name]                    
                                                    FROM    dbo.WAT_HotelCodeMaster                    
                      WHERE   FreezeStatus = 0                    
                                                    ORDER BY 2;                    
                                                END;                    
                                            ELSE                    
                                                IF @option = 'WAT_Reason'                    
                                                    BEGIN                                      
                                                        SELECT                    
                                                              ReasonMID AS [ID] ,                    
                                                              Reason AS [Name]                    
                                                        FROM  dbo.WAT_ReasonMaster                    
                                                        WHERE FreezeStatus = 0                    
                                                        ORDER BY OrderID;                    
                                                    END;                    
                                                ELSE                    
       IF @option = 'WAT_AgentWorkGroups'                    
                                                        BEGIN                    
                                                            IF CAST(@option2 AS INT) IN (                    
                                                              5 )                    
                                                              BEGIN                                
                                                              SELECT  DISTINCT                    
                            CAST(WGM.WorkGMID AS VARCHAR)                    
                           + '~'                    
                                                              + CAST(C.CampaignID AS VARCHAR) AS [WorkGMID] ,                    
                                 WGM.WorkGroupName AS [WorkGroupName] ,                    
                                                              ID = WGM.WorkGMID ,                    
                                                              Name = WGM.WorkGroupName                    
                                                          FROM                    
                                            dbo.WAT_WorkGroupMaster WGM                    
                                                              JOIN dbo.WAT_WorkGroupCampaignDetail WGCD ON WGCD.WorkGMID = WGM.WorkGMID                    
                                                              AND WGCD.FreezeStatus = 0                    
                                                              JOIN EmeraldHierarchies_MVC.dbo.Campaigns C ON C.CampaignID = WGCD.CampaignID                    
                                                              AND C.ProjectID IS NOT NULL                    
          --AND ISNULL(C.WAT_AgentAccess, 0) = 1                    
                                                              WHERE                    
                                                              WGM.FreezeStatus = 0                    
                                                              ORDER BY 2;                        
                                                              END;                      
                                                            ELSE                    
                                        IF CAST(@option2 AS INT) IN (                    
                                        4, 6 )                    
                                             BEGIN                                
                                                              SELECT  DISTINCT                    
                                                              CAST(WGM.WorkGMID AS VARCHAR)                    
                                                              + '~'                    
                        + CAST(C.CampaignID AS VARCHAR) AS [WorkGMID] ,                    
                                                              WGM.WorkGroupName AS [WorkGroupName] ,                    
                                                              ID = WGM.WorkGMID ,                    
                                                              Name = WGM.WorkGroupName                    
                                                              FROM                    
                                                              dbo.WAT_WorkGroupMaster WGM                    
                                                              JOIN dbo.WAT_WorkGroupCampaignDetail WGCD ON WGCD.WorkGMID = WGM.WorkGMID                    
                                                              AND WGCD.FreezeStatus = 0                    
                                                              JOIN EmeraldHierarchies_MVC.dbo.Campaigns C ON C.CampaignID = WGCD.CampaignID                    
                                                              AND C.ProjectID IS NOT NULL                    
           --AND ISNULL(C.WAT_AgentAccess, 0) = 1                    
                                                              WHERE                    
                                                              WGM.FreezeStatus = 0                    
                                                              AND WGM.ClientID IN (                    
                                                              SELECT                    
                                 ClientID                    
                                                              FROM                    
                        dbo.ClientLoginMappingDetail                    
                                                              WHERE                    
                                                              [STATUS] = 0                    
                                                              AND LoginMID = @option1 )                    
                                             ORDER BY 2;                        
                                                       END;                        
                                                              ELSE                    
                                                              IF CAST(@option2 AS INT) < 4                    
                                          BEGIN                                
                                          SELECT  DISTINCT                    
                                                              CAST(WGM.WorkGMID AS VARCHAR)                    
                                 + '~'                    
                                                              + CAST(WGCD.CampaignID AS VARCHAR) AS [WorkGMID] ,                    
                                                              WGM.WorkGroupName AS [WorkGroupName] ,                    
                                                              ID = WGM.WorkGMID ,                    
                                                 Name = WGM.WorkGroupName                    
                                                              FROM                    
                                                              dbo.WAT_WorkGroupMaster WGM                    
                                                              JOIN dbo.WAT_WorkGroupCampaignDetail WGCD ON WGCD.WorkGMID = WGM.WorkGMID                    
                                                              AND WGCD.FreezeStatus = 0                    
 JOIN EmeraldHierarchies_MVC.dbo.Campaigns C ON C.CampaignID = WGCD.CampaignID                    
                                                              AND C.ProjectID IS NOT NULL                    
                        --AND ISNULL(C.WAT_AgentAccess, 0) = 1                    
                                                              WHERE                    
               WGM.FreezeStatus = 0                    
                                                              AND WGM.ClientID IN (                    
                                                              SELECT                    
                                                              ClientID                    
                                                              FROM                    
                                                              dbo.ClientLoginMappingDetail             
                                                              WHERE                    
                                                              [STATUS] = 0                    
                                                              AND LoginMID = @option1 )                    
                                                              ORDER BY 2;                    
                                                              END;                                
                                                              ELSE                    
                                                              IF CAST(@option2 AS INT) IN (                    
                                                              16, 7 )                    
                                                              BEGIN                                
                                                              SELECT  DISTINCT                    
                                                              CAST(WGM.WorkGMID AS VARCHAR)                    
                                                              + '~'                    
                                                              + CAST(WGCD.CampaignID AS VARCHAR) AS [WorkGMID] ,                    
                                                              WGM.WorkGroupName AS [WorkGroupName] ,                    
                                                              ID = WGM.WorkGMID ,                    
                              Name = WGM.WorkGroupName                    
                                                              FROM                    
                                                              dbo.WAT_WorkGroupMaster WGM                    
             JOIN dbo.WAT_WorkGroupCampaignDetail WGCD ON WGCD.WorkGMID = WGM.WorkGMID                    
                                                              AND WGCD.FreezeStatus = 0                    
                                                              JOIN EmeraldHierarchies_MVC.dbo.Campaigns C ON C.CampaignID = WGCD.CampaignID                    
       AND C.ProjectID IS NOT NULL                    
                                                              AND ISNULL(C.WAT_AgentAccess,                    
                           0) = 1                    
                                               JOIN dbo.WAT_WorkGroupAgentDetail WGAD ON WGAD.WorkGMID = WGM.WorkGMID                    
                                                              AND WGAD.LoginMID = @option1                    
                                                              WHERE                    
                                                      WGM.FreezeStatus = 0                    
                                                              AND WGM.ClientID IN (                    
                                                              SELECT                    
                                                              ClientID                    
                                                              FROM                    
                                                              dbo.ClientLoginMappingDetail                    
                                                              WHERE                    
                                                              [STATUS] = 0                    
                                                              AND LoginMID = @option1 )                
                                                              ORDER BY 2;                        
                                                              END;                        
                                                        END;                    
                                                    ELSE                    
    IF @option = 'WAT_SuggestiveCodes'                    
                                  BEGIN                                      
                                                              SELECT                    
                            ISNULL(SuggestiveProperty1,                    
                                                              '') AS SuggestiveProperty1 ,                    
                                                              ISNULL(SuggestiveProperty2,                    
                                                              '') AS SuggestiveProperty2                    
                                                              FROM                    
                                                              dbo.WAT_HotelCodeMaster                    
                                                              WHERE                    
                                                              FreezeStatus = 0                    
                                                              AND HotelCode = @option3;                    
                                                            END;                    
                                                        ELSE                    
                                                            IF @option = 'WAT_HiltonDesks'                    
                                                              BEGIN                                      
                                                              SELECT                    
                                                              DeskMID AS [ID] ,                    
                                                DeskName AS [Name]                    
                                                              FROM                    
                                                              dbo.WAT_DeskMaster_Hilton                    
                                                              WHERE                    
      FreezeStatus = 0                    
                           ORDER BY 2;                    
                                                              END;                    
       ELSE                    
                                                              IF @option = 'WAT_HotelCode_Auto'                    
                                                              BEGIN                    
                                                              DECLARE @str VARCHAR(MAX)= '';                    
                                     SET @str = 'SELECT  HotelCode                    
      FROM    dbo.WAT_HotelCodeMaster                    
      WHERE   FreezeStatus = 0                    
        AND HotelCode LIKE ( ''%' + @option3 + '%'' )                    
      ORDER BY 1';                    
                                                              PRINT ( @str );                    
                                                              EXEC(@str);                    
                                            END;                    
                                              ELSE                    
                                                              IF @option = 'WAT_Hilton_New'                    
                                                              BEGIN                                      
SELECT                    
    CallTypeMID AS [ID] ,                    
                                                              CallType AS [Name]                    
                                                              FROM                    
                        dbo.WAT_TypeOfCall_Hilton                    
                                                              WHERE                    
                                                              FreezeStatus = 0                    
                                                              ORDER BY OrderID;                    
                    
                                                     SELECT                    
                                                              PurposeTypeMID AS [ID] ,                    
                                                              PurposeType AS [Name]                    
                                                              FROM                    
                                                              dbo.WAT_PurposeOfStay                    
    WHERE                    
                                                              FreezeStatus = 0                    
                                                              ORDER BY OrderID;                    
                    
                                                              SELECT                    
   RescueMID AS [ID] ,                    
                                                              Rescue AS [Name]                    
                                                              FROM                    
                                                              dbo.WAT_Rescue_Hilton                    
                                                              WHERE                    
                                                              FreezeStatus = 0                    
                                                              ORDER BY OrderID;                    
                    
                    
                                                              SELECT                    
                                                              ReasonMID AS [ID] ,                    
                                                              Reason AS [Name]                    
                                                              FROM                    
                                                              dbo.WAT_ReasonMaster                    
                                                              WHERE                    
                                                              FreezeStatus = 0                    
   ORDER BY OrderID;                    
                                                              END;                    
                                                              ELSE                    
                                                              IF @option = 'Staging'                    
           BEGIN                                         
      SELECT                    
                                                              ID = 4 ,              
                                                              Name = 'Avaya'                    
                                                              UNION                    
  SELECT                    
                                                              ID = 7 ,                    
                                                              Name = 'Cross Sell'                    
                                                              UNION                    
                                                              SELECT                    
                       ID = 5 ,                    
                         Name = 'Verient PET'                    
                                                              UNION                    
                                                              SELECT                    
                 ID = 6 ,                    
                           Name = 'Verient'                    
                                                         UNION                    
           SELECT                    
                                                              ID = 8 ,                    
                                                              Name = 'KRO Performance'                    
                                                         UNION                    
                                                SELECT                    
                                                              ID = 9 ,                    
                                                              Name = 'Mishandling'                    
                                                              UNION                    
                                                              SELECT                    
                                                              ID = 10 ,                    
                                                              Name = 'Attendance '                    
                                                              ORDER BY Name;                    
                                  
                                                              END;                    
                                                              ELSE                    
                                                              IF @option = 'upload'                    
                                                              BEGIN                                         
                                                        
                                                              SELECT                    
                                                              ID = UMID ,                    
                                                              Name = Name                    
                                                              FROM                    
                                                     UploadMaster                    
                                                              WHERE                    
                                                              ClientID = @option1                    
                                                              AND FreezeStatus = 0                    
                                                              ORDER BY [Order];                    
                                  
                                                              END;                    
                                                                                  
                                                              ELSE                    
                                                              IF @option = 'Menuexception client'                    
                                                              BEGIN                    
                                                              SELECT DISTINCT                    
                                    ID = CL.ClientID ,                    
                                                              Name = CL.ClientName                    
                                                              FROM                    
      EmeraldHierarchies_MVC.dbo.Clients CL                    
                                                              JOIN ClientLoginMappingDetail CLMD ON CL.ClientID = CLMD.ClientID                    
                                                              AND CLMD.[STATUS] = 0                    
                                                              WHERE                    
                                                              CLMD.LoginMID = @option1                    
                                                          AND IsActive = 1                    
                                                              ORDER BY CL.ClientName;                       
                                                              END;                    
                                                              ELSE        
                                                              IF @option = 'menu Access'                    
                                                              BEGIN                    
             SELECT DISTINCT                    
                                                              ID = alm.AccessLMID ,                    
                                                              Name = alm.Accesslevel                    
                                                              FROM                    
                               AccessLevelMaster alm                    
                                                              WHERE                    
                                                              alm.FreezeStatus = 0                    
                                                              AND alm.AccessLMID <> 5                    
                          ORDER BY alm.Accesslevel;                    
                                                              END;                    
                                                              ELSE                    
                                                              IF @option = 'AutoLoginEmployee'                    
                                                              BEGIN                    
                    
                                                              IF @option1 = ''                    
                                                              SET @option1 = '0';                    
                    
                                                              IF @option2 = ''                    
                                                              SET @option2 = '0';                    
                    
                                                              SELECT top 1000                    
                                                              ID = LoginMID ,                    
                                                              Name = EmployeeName ,                    
                                                              GlobalUserID                    
                                                              FROM                    
                                                              Prism_Datamart_MVC.dbo.LoginMaster                    
                                                              WHERE                    
                                                              DefaultClientID = @option1                    
                      AND AccessLMID = @option2                    
                                                       AND FreezeStatus = 0                    
                                                              ORDER BY EmployeeName;                    
                                                              END;                    
                    
                                                              ELSE                    
                                                              IF @option = 'AdminTeam'                    
                                                              BEGIN                    
                                                              SELECT                    
                                                              ID = GlobalUserRoleTypeID ,                    
                         Name = RoleName                    
                                 FROM                    
                                          EmeraldHierarchies_MVC.dbo.GlobalUserRoleTypes                
                                                              WHERE                    
                                                              GlobalUserRoleTypeID NOT IN (                    
                                                  1, 5 )                    
                                                              ORDER BY GlobalUserRoleTypeID;                                                                          END;                    
                                                              ELSE                 
                                                              IF @option = 'AdminTeamEmployee'                    
                                                              BEGIN                    
                                                              IF @option1 = ''                    
                                                              SET @option1 = '0';                    
                    
                                                              IF @option2 = ''                    
                                                              SET @option2 = '0';                    
                                                              SELECT                    
                                                              Name = gu.FirstName                    
                                                              + ' '                    
                                                              + gu.LastName ,                    
                                 ID = gu.GlobalUserID                    
                                                              FROM                    
                                            EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers hrgu                    
                                                              INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUsers gu ON gu.GlobalUserID = hrgu.GlobalUserID                    
                                                              INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUserRoles gur ON gur.GlobalUserID = hrgu.GlobalUserID                    
                                                              AND gur.FreezeStatus = 0                    
                                                              AND gur.EndDate = '2099-12-31 00:00:00.000'                    
                                                              WHERE                    
                                                              hrgu.RoleLeaveDate IS NULL                    
                                                              AND hrgu.Leaver = 0                    
                                                              AND hrgu.ClientID = @option1                    
                                                              AND gur.GlobalUserRoleTypeID = @option2;                    
                                                              END;                    
                    
               ELSE                    
                                                              IF @option = 'upload client'                    
                                                              BEGIN                    
              IF @option2='1'                    
              BEGIN                    
            SELECT DISTINCT                                            
                                                              ID = CL.ClientID ,                    
                                                              Name = CL.ClientName                    
                                                              FROM                    
                                                              EmeraldHierarchies_MVC.dbo.Clients CL                    
                                                           INNER JOIN ClientLoginMappingDetail CLMD ON CL.ClientID = CLMD.ClientID  AND CLMD.[Status] = 0                    
               INNER JOIN uploadmaster um ON um.UploadType=0 AND um.ClientID=CL.ClientID                    
                WHERE                    
                                                              CLMD.LoginMID = @Option1                    
                                                              AND isactive = 1                    
     ORDER BY CL.ClientName                     
END                    
ELSE                    
BEGIN            
        SELECT DISTINCT                    
           ID = CL.ClientID ,                    
                                                              Name = CL.ClientName                    
                                                              FROM                    
                                                              EmeraldHierarchies_MVC.dbo.Clients CL                    
                                                              JOIN ClientLoginMappingDetail CLMD ON CL.ClientID = CLMD.ClientID                    
   AND CLMD.[Status] = 0                    
                                                   WHERE                    
              CLMD.LoginMID = @Option1                    
                                                              AND isactive = 1                    
        ORDER BY CL.ClientName                       
              END                     
                                                              END                    
                    
                                                              ELSE                    
                                                              IF ( @option = 'ReportType' )                    
                                                              BEGIN                    
                                                              SELECT                    
                                                              ReportTypeID AS ID ,                    
                                                              ReportType AS Name                    
                                                              FROM                    
                                                   dbo.ReportTypeMaster                    
                                                              WHERE                    
                                                         FreezeStatus = 0                    
       ORDER BY 2;                    
                                                              END;                    
                    
                                                              ELSE                    
                                                              IF ( @option = 'ReportServer' )                    
                                                              BEGIN                    
                                                              SELECT                    
        ReportSID AS ID ,                    
                    ServerName AS Name                    
                                                              FROM                    
                                                              dbo.ReportServer                    
                                                              WHERE                    
                                                              FreezeStatus = 0                    
                                                              ORDER BY 2;                    
                                                              END;                    
                                                              ELSE                    
                                                              IF ( @option = 'ReportFolder' )                    
                                                              BEGIN                    
              SELECT                    
                                                              ReportFID AS ID ,                    
                                                              FolderName AS Name                    
                                                              FROM                    
                                                              dbo.ReportFolder                    
                                                              WHERE                    
                                                              ISNULL(FreezeStatus,                    
    0) = 0    
                                                              AND ReportSID = @option1                    
         ORDER BY 2;                    
                                                              END;                    
                                                              ELSE                    
                                                              IF ( @option = 'DockType' )                    
                     BEGIN                    
                                                              SELECT                    
                                                              ID AS ID ,                    
                                                              Doc_Type AS Name                    
                                                              FROM                    
                                                              dbo.TransUnion_DocType                    
                                                              ORDER BY 2;                    
                                                              END;                    
                                                              ELSE                    
                                                              IF ( @option = 'WATDropDownFill' )                    
                                                              BEGIN                    
     --option1=level option2=workdmid(if level1)/parentid                    
                                                              IF @option1 = '1'                    
                                                              BEGIN                    
                                                              SELECT                    
                                                              ID ,                    
                                                              Name = OptionName                    
                                                              FROM                    
                                                              dbo.WAT_DropDownMaster                    
                                                              WHERE                    
                                    WorkDMID = @option2                    
                                                              AND ParentID IS NULL                    
                                                              AND FreezeStaus = 0                    
                 ORDER BY OptionName;                    
                                                              END;                    
                                                              ELSE                    
                                                              BEGIN                    
                                                              SELECT                    
                                                              ID ,                    
                                                              Name = OptionName                    
                                             FROM                    
                           dbo.WAT_DropDownMaster                    
                                                 WHERE                    
                                                              ParentID = @option2                    
                                                              AND FreezeStaus = 0                    
                                                              ORDER BY OptionName;                    
                                                              END;                    
                                    
                                                              END;                    
                                      
                                                              ELSE                    
  IF @option = 'ProjectForMess'                    
      BEGIN                    
                                                              SET @option2 = ISNULL(@option2,                    
                                                              0);                    
                                                       IF ( SELECT                    
                        AccessLMID                    
                                              FROM                    
                                                              dbo.LoginMaster                    
                                                              WHERE                    
                                                              LoginMID = @option2                    
                                                              ) = 5                    
                     BEGIN                     
                                                              SET @strsql = 'SELECT  ID = ProjectID ,                    
              Name = ProjectName                    
            FROM    EmeraldHierarchies_MVC.dbo.Projects                    
            WHERE   isactive = 1                    
              AND ClientID in ('                    
                                                              + @option1 + ')                    
            ORDER BY ProjectName';                    
                                                              END;                    
                                                              ELSE                    
                                                              BEGIN                     
                    
                                                              SET @strsql = 'SELECT  ID = p.ProjectID ,                    
                                    Name = p.ProjectName                    
                            FROM    EmeraldHierarchies_MVC.dbo.Projects p                    
                                    INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUserProjects gup ON p.ProjectID = gup.ProjectID                    
                                                              AND gup.EndDate > GETDATE()                    
                                                              AND gup.FreezeStatus = 0                    
                                    INNER JOIN dbo.LoginMaster lm ON lm.GlobalUserID = gup.GlobalUserID                    
                            WHERE   lm.LoginMID = '                    
                                                              + CAST(@option2 AS VARCHAR);                     
                    
                           
                                                              END;                     
                    
                                                              EXEC(@strsql);                    
        --SELECT  ID = ProjectID ,                    
        --      Name = ProjectName                    
        --    FROM    EmeraldHierarchies_MVC.dbo.Projects                    
        --    WHERE   isactive = 1                    
        --      AND ClientID in (                    
        --                                                       @Option1                    
        --                                                     )                    
        --    ORDER BY ProjectName                    
                    
                                      END;                    
        IF @option = 'MessageBroadCastCategory'                    
            BEGIN                    
                SELECT  CategoryID AS ID ,                    
                        MessageCategory AS Name                    
                FROM    MessageBroadcastCategory;                    
            END;                    
        ELSE                    
            IF ( @option = 'AccessForMess' )                    
                BEGIN                    
                                        IF @option1 = '1'                    
                        SELECT  CAST(AccessLMID AS VARCHAR(10)) AS ID ,                    
              Accesslevel Name                    
                        FROM    AccessLevelMaster                    
  WHERE   AccessLMID IN ( 16 )                    
                        ORDER BY AccessLMID;                    
                    ELSE                    
                        IF @option1 = '7'                    
         SELECT  CAST(AccessLMID AS VARCHAR(10)) AS ID ,                    
                                    Accesslevel Name                    
                            FROM    AccessLevelMaster                                          WHERE   AccessLMID IN ( 16 )                    
                            ORDER BY AccessLMID;                    
                        ELSE                    
                         SELECT  CAST(AccessLMID AS VARCHAR(10)) AS ID ,                    
                                    Accesslevel Name                    
        FROM    AccessLevelMaster                    
                            WHERE   AccessLMID IN ( 1, 2, 6, 7, 9, 16 )                    
                            ORDER BY AccessLMID;                    
                    
                                             
                END;                     
                        
    ELSE  IF @option = 'WorkGroupForMessageBoardCast'                    
                                                              BEGIN                    
            IF ( SELECT                    
                                                              AccessLMID                    
                                                              FROM                    
                                 dbo.LoginMaster                    
                                                              WHERE                    
                                                              LoginMID = @option1                    
                                                 ) = 5                    
                      BEGIN                     
                                                              SET @strsql = 'SELECT  ID = w.WorkGMID ,                    
                                    Name = ww.WorkGroupName                    
                            FROM    dbo.WAT_WorkGroupTLDetail w                    
       INNER JOIN dbo.WAT_WorkGroupMaster ww ON ww.WorkGMID=w.WorkGMID                    
                                    INNER JOIN dbo.LoginMaster lm ON lm.LoginMID = w.LoginMID';                    
                                                              END;                    
                                                              ELSE                    
                                                              BEGIN                     
                    
                                                              SET @strsql = 'SELECT  ID = w.WorkGMID ,                    
                                    Name = ww.WorkGroupName                    
                            FROM    dbo.WAT_WorkGroupTLDetail w                    
       INNER JOIN dbo.WAT_WorkGroupMaster ww ON ww.WorkGMID=w.WorkGMID                    
                                    INNER JOIN dbo.LoginMaster lm ON lm.LoginMID = w.LoginMID                    
                            WHERE   w.LoginMID =  '                    
                                                              + CAST(@option1 AS VARCHAR);                     
                    
                           
                                                              END;                     
                    
                                                              EXEC(@strsql);                    
                 END                    
                IF (@Option = 'MultiselectMiscColumnData' )                    
                            BEGIN                    
                                                              SELECT DDLMID AS ID, Name AS Name FROM WAT_DynamicDDLMst WHERE DOCDID = @Option1                            
                          END                    
              ELSE IF ( @option = 'MDOrganizationType' )                    
                BEGIN                    
                --Option1 For ClientID                    
                SELECT ID=OrganisationMID,Name=OrganisationName FROM EmeraldHierarchies_MVC.dbo.MD_OrganisationType WHERE FreezeStatus=0                    
                END                    
             ELSE IF (@Option = 'MohreLanguage')                    
             BEGIN                    
              SELECT ID=id,Name=Language FROM Mohre.dbo.LanguageMaster                    
             END                    
             ELSE IF (@Option = 'MohreServices')                    
             BEGIN                    
              IF(ISNULL(@Option1,'')<>'')                    
              BEGIN                    
               SET @strsql='SELECT ID=ServiceID,Name=ServiceName FROM Mohre.dbo.ServiceDetails as SD WHERE SD.Freezestatus=0 AND SD.LngID IN ('+@Option1+')'                    
               EXEC(@strsql);                    
              END                    
          ELSE                    
              BEGIN                    
               SELECT ID=SDID,Name=ServiceName FROM Mohre.dbo.ServiceDetails as SD WHERE SD.Freezestatus=0                    
              END                    
             END                    
             ELSE IF (@Option = 'KPIDetails')                    
             BEGIN                    
              SELECT ID,Name FROM Mohre.dbo.KPIDetails WHERE Freezestatus=0                    
             END                    
             ELSE IF (@Option = 'EquiQUEUE')                    
             BEGIN                    
              select ID , QueueName AS Name  From  Equifax.dbo.Queues where Freezestatus=0 AND QueueName <>'-'                    
             END                    
        else if(@Option='MohreWeek')                    
             begin                    
       SELECT DISTINCT ID = CONVERT(VARCHAR(10), StartDate_Mohre, 121) ,Name = REPLACE(CONVERT(VARCHAR(11), StartDate_Mohre, 106), ' ', '-')                    
          + ' to ' + REPLACE(CONVERT(VARCHAR(11), EndDate_Mohre, 106), ' ','-'),StartDate_Mohre                    
       FROM    dbo.WeekMaster WHERE   WeekID_Mohre IS NOT NULL and date<getdate() order by StartDate_Mohre desc                    
                           
                           
       end                    
       else if(@Option='EquiWeek')                    
             begin                    
       SELECT DISTINCT ID = CONVERT(VARCHAR(10), StartDate_Mohre, 121) ,Name = REPLACE(CONVERT(VARCHAR(11), StartDate_Mohre, 106), ' ', '-')                  
          + ' to ' + REPLACE(CONVERT(VARCHAR(11), EndDate_Mohre, 106), ' ','-'),StartDate_Mohre                    
       FROM    dbo.WeekMaster WHERE   WeekID_Mohre IS NOT NULL and date<getdate() order by StartDate_Mohre desc                    
                           
                           
       --SELECT  CONVERT(VARCHAR(11),MIN([Date]),106) AS ID ,REPLACE(CONVERT(VARCHAR(11), MIN([Date]), 106), ' ', '-')                    
       --   + ' to ' + REPLACE(CONVERT(VARCHAR(11), MAX([Date]), 106), ' ','-') AS Name                    
       --FROM    dbo.WeekMaster WHERE   [Date] >= '2012-10-01'  GROUP BY WeekID_Mohre ORDER BY MIN([Date])                    
                           
       end                    
       ELSE IF (@Option = 'EquiMainCategory')                    
             BEGIN                    
              select MainCategoryID AS ID,Name From equifax.dbo.MainCategory where InUse=1                    
             END                    
       ELSE IF (@Option = 'Chart')                    
       BEGIN              
        SELECT  ChartType AS Name , ChartID, Image AS Image FROM    chartMaster                             
        WHERE   FreezeStatus = 0  ORDER BY Name asc                         
       END                    
       ELSE IF (@Option = 'Operator')                    
       BEGIN                    
          SELECT  OperationMID AS ID ,Operation AS Name ,ColumnType FROM    dbo.ArithmaticOperationMaster  WHERE   FreezeStatus = 0                           
       END                    
       ELSE IF (@Option = 'ChartField')                    
       BEGIN                    
         SELECT SMRD.ReportRDID AS ColumnMID,SMRD.ReportHeader AS ColumnName,ICDT.DataType , ColumnType,Groupby   FROM SmartMangerReportDetails SMRD                       
         JOIN  SmartMangerReportMaster SMRS ON SMRS.ReportID=SMRD.ReportID                      
         JOIN ImportConfigurationDataType ICDT ON ICDT.DTID=SMRD.DataTypeID                       
         WHERE SMRS.ReportLinkID=@option1 AND SMRD.FreezeStatus=0                           
       END                    
       ELSE IF (@Option = 'SMReportType')                    
       BEGIN                    
          SELECT ReportTypeID AS ID,Report AS Name From ClientReportType WHERE ReportLinkID=@option1 AND FreezeStatus=0                    
       END                    
                          
      ELSE IF @option = 'SM_CDM'  --Option1:AccessLMID,Option2:ClientIDs,Option3:GlobalUserID                    
                        BEGIN                    
                            DECLARE @SMCDMClientStr VARCHAR(500)= ''                    
             DECLARE @SMCDMCDDStr VARCHAR(500)= ''                    
                            IF ( @option2 <> '' )                    
                                BEGIN                    
                                    SET @SMCDMClientStr = ' AND c.ClientID in ('                    
                                        + @option2 + ')'                    
                                END                    
        IF ( @option4 <> '' )                    
                                BEGIN                    
                                    SET @SMCDMCDDStr = ' AND gur.ParentGlobalUserID in ('                    
                                        + @option4 + ')'                    
                                END                    
                            IF @option1 = '5'                    
                                SET @strsql = 'SELECT DISTINCT                    
            Name = gu.FirstName + '' '' + gu.LastName ,                    
            ID = gu.GlobalUserID                    
          FROM    EmeraldHierarchies_MVC.dbo.GlobalUsers gu                    
            INNER JOIN EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers HRGU ON HRGU.GlobalUserID = gu.GlobalUserID                    
                          AND HRGU.RoleLeaveDate IS NULL                    
            INNER JOIN EmeraldHierarchies_MVC.dbo.Clients c ON CAST(c.ClientID AS VARCHAR(50)) = HRGU.ClientID                    
            INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUserRoles gur ON gur.GlobalUserID = gu.GlobalUserID                    
                          AND ISNULL(gur.freezestatus,                    
                          0) = 0                    
          WHERE   1 = 1                    
            ' + @SMCDMClientStr                    
                                    + '                    
            AND gu.GlobalUserID NOT IN ( SELECT GlobalUserID                    
                    FROM   Prism_DataMart_NewInstance.dbo.LoginMaster                    
                    WHERE  AccessLMID IN ( 5, 6 ) )                    
            AND gur.GlobalUserRoleTypeID in (2,3)'+@SMCDMCDDStr                    
                            ELSE                    
                IF ( @option1 = '6' )                    
                                    SET @strsql = 'SELECT DISTINCT Name=gu.FirstName + '' '' + gu.LastName,ID=gu.GlobalUserID                    
               FROM    EmeraldHierarchies_MVC.dbo.GlobalUsers gu                     
                 inner join EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers HRGU on HRGU.GlobalUserID=gu.GlobalUserID and HRGU.RoleLeaveDate IS NULL                     
                 INNER JOIN EmeraldHierarchies_MVC.dbo.Clients c ON cast(c.ClientID as varchar(50))=HRGU.ClientID              
                 INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUserRoles gur ON gur.GlobalUserID = gu.GlobalUserID  and isnull(gur.freezestatus,0)=0                    
               WHERE 1=1   '                    
                                        + @SMCDMClientStr                    
                                        + ' AND                     
                 c.ClientID in (select distinct ClientID from ClientLoginMappingDetail where globaluserid='''                    
                                        + @Option3                    
                                        + ''' and [status]=0)                    
                 and             
                 gu.GlobalUserID NOT IN (                    
                 SELECT  GlobalUserID                    
                 FROM    Prism_DataMart_NewInstance.dbo.LoginMaster                    
                 WHERE   AccessLMID IN ( 5, 6 ) )                    
                 AND gur.GlobalUserRoleTypeID in (2,3)'+@SMCDMCDDStr                    
                                ELSE                    
                                    SET @strsql = 'SELECT DISTINCT  Name=gu.FirstName + '' '' + gu.LastName,ID=gu.GlobalUserID                    
          FROM EmeraldHierarchies_MVC.dbo.GlobalUsers gu                     
            inner join EmeraldHierarchies_MVC.dbo.HRUserRolesGlobalUsers HRGU on HRGU.GlobalUserID=gu.GlobalUserID and HRGU.RoleLeaveDate IS NULL                     
            INNER JOIN EmeraldHierarchies_MVC.dbo.Clients c ON cast(c.ClientID as varchar(50))=HRGU.ClientID                    
            INNER JOIN EmeraldHierarchies_MVC.dbo.GlobalUserRoles gur ON gur.GlobalUserID = gu.GlobalUserID and isnull(gur.freezestatus,0)=0                    
          WHERE  1=1  ' + @SMCDMClientStr                    
                                        + ' AND                     
             c.ClientID in (select distinct ClientID from ClientLoginMappingDetail where globaluserid='''                    
                                        + @Option3                    
                                        + ''' and [status]=0)                    
            AND gu.GlobalUserID NOT IN (                    
            SELECT  GlobalUserID                    
            FROM    Prism_DataMart_NewInstance.dbo.LoginMaster                    
            WHERE   AccessLMID IN ( 5, 6 ) )                    
            AND gur.GlobalUserRoleTypeID  in (2,3)                    
            AND gur.ParentGlobalUserID='''                    
         + @Option3 + '''' +@SMCDMCDDStr                       
                                
                            PRINT ( @strsql )                    
                            EXEC(@strsql)                        
                        END                    
                    
      ELSE IF @option = 'Assets'                    
      BEGIN                             
        SELECT ID=AssetCategoryID,Name=CategoryName FROM AssetCategoryMaster WHERE FREEZESTATUS=0                    
      END                    
      ELSE IF @option = 'AssetsProcess'                    
       BEGIN                             
        SELECT ID=ProcessID,Name=ProcessName FROM AssetProcessMaster WHERE FREEZESTATUS=0 order by ProcessName                    
      END                    
      ELSE IF @option = 'AssetSubProcessMaster'                    
      BEGIN                             
        SELECT ID=SubProcessID,Name=SubProcessName FROM AssetSubProcessMaster WHERE PROCESSID=@option1 AND FREEZESTATUS=0 order by SubProcessName                    
      END                    
      ELSE IF @option = 'AssetLocation'                    
     BEGIN                             
        SELECT ID=AssetLocationID,Name=Location FROM AssetLocationMaster WHERE FREEZESTATUS=0 order by Location                    
      END                           
      ELSE IF @option = 'AssetStatus'                    
      BEGIN                             
        SELECT ID=AssetStatusID,Name=[Status] FROM AssetStatusMaster WHERE FREEZESTATUS=0                    
      END                    
      ELSE IF @option = 'AssetOwner'                    
      BEGIN                             
   SELECT ID=AssetOwnerID,Name=Owner FROM AssetOwnerMaster WHERE FREEZESTATUS=0                    
      END                    
      ELSE IF @option = 'AssetSite'                    
      BEGIN                             
        SELECT ID=AssetSiteID,Name=Site FROM AssetSiteMaster WHERE FREEZESTATUS=0 order by Site                    
      END                    
      ELSE IF @option = 'AssetFunction'                    
      BEGIN                             
        SELECT ID=AssetFunctionID,Name=FunctionName FROM AssetFunctionMaster WHERE FREEZESTATUS=0 order by FunctionName                    
      END                    
      ELSE IF @option = 'AssetInternetConnectivity'                    
      BEGIN                             
        SELECT ID=AssetInternetID,Name=InternetName FROM AssetInternetConnectivityMaster WHERE FREEZESTATUS=0                    
      END                     
      ELSE IF @option = 'AssetState'                    
BEGIN                             
SELECT ID=ID,Name=StateName FROM AssetStateMaster WHERE FREEZESTATUS=0                    
END                    
 ELSE IF @option = 'LocationSearch'                    
BEGIN                             
 SELECT ID=[Location],  [Location]  AS Name from WAHAOfficeLocation where freezestatus=0  order by [Location]                    
END                    
 ELSE IF @option = 'TPCoustomerRecommender'                    
      BEGIN                             
         SELECT ID= ProductID, ProductName  AS label from TPRecommander_Product where ProductName like  '%'+ @option3+'%' and ProductName <> 'none'   and freezestatus=0                       
      END                    
      ELSE IF @option = 'TPCatDevice'                    
      BEGIN                      
        SELECT ID= ProductID,Name= ProductName   from TPRecommander_Product where CategoryID=1 AND  freezestatus=0 AND status <>'Discontinued'                    
      END                    
      ELSE IF @option = 'TPCatPlan'                    
      BEGIN                             
         SELECT ID= ProductID, Name= ProductName   from TPRecommander_Product where CategoryID=2 AND  freezestatus=0 AND status <>'Discontinued'                     
      END                    
       else IF @option = 'WAT_TPRecommenderDesks'                    
                                                              BEGIN                                      
                                                              SELECT                    
                                                              DeskMID AS [ID] ,                    
                                                              DeskName AS [Name]                    
                                                              FROM                    
                                                              dbo.WAT_DeskMaster_TPRecommender                    
                                                              WHERE                    
                                     FreezeStatus = 0                    
                           ORDER BY 2;                    
                                                              END;                    
      ELSE IF @option = 'TPDomain'                    
      BEGIN   
       SELECT ID=cast(ID as varchar(10)),Name=DomainDetail +isnull(' ('+DomainName+')','') FROM TPDomain WHERE FreezeStatus=0                    
      END                    
                    
      ELSE IF @option = 'WorkItemALG'                    
      BEGIN                             
       IF (ISNULL(@option1, 0)=0)                    
      BEGIN                    
      DECLARE @CampaignIDS INT                    
       SET @option1 = ( SELECT TOP 1                    
              WorkGMID                    
             FROM      dbo.WAT_WorkGroupAgentDetail                    
             WHERE     LoginMID = @option2                    
              AND FreezeStatus = 0                    
           );                    
       END                    
         SET @CampaignIDS = ( SELECT TOP 1                    
             CampaignID                    
              FROM    dbo.WAT_WorkGroupCampaignDetail                    
              WHERE   WorkGMID = @option1                    
                AND FreezeStatus = 0                    
               );                    
         SET @option1 = ISNULL(@option1, 0);                    
         SET @CampaignIDS = ISNULL(@CampaignIDS, 0);                    
         SELECT  ID= CAST(wtm.WorkIMID AS VARCHAR(20)) ,                    
           Name=WorkItemName                                 
         FROM    dbo.WAT_WorkGroupWorkDivisionDetail wgwdd                    
           INNER JOIN dbo.WAT_WorkDivisionWorkItemDetail wdwtd ON wgwdd.WorkDMID = wdwtd.WorkDMID                    
           INNER JOIN dbo.WAT_WorkItemMaster wtm ON wdwtd.WorkIMID = wtm.WorkIMID                    
                                        
         WHERE   wdwtd.WorkDMID = @option3 ---AND wdwtd.freezestatus=0;                    
        END                    
      ELSE IF @option = 'IncidentLocation'                    
      BEGIN                             
       SELECT CAST(ID AS VARCHAR(10)) AS ID, Name= [Location]  from WAHAOfficeLocation where freezestatus=0  order by 2---- [Location] like   @option+'%'   and                     
      END                    
      ELSE IF @option = 'WAHAIncident'                    
BEGIN                             
 SELECT CAST(ID AS VARCHAR(10)) AS ID, Name= [Incident]  from WAHA_NatureIncident where freezestatus=0                       
END                 
            
 ELSE IF @option = 'BindUploadName'                    
      BEGIN                             
     select UMID AS ID,Name AS Name from uploadMaster where  ClientID=@option1 and FreezeStatus=0            
      END                
               
               
 ELSE IF @option = 'BindColumnHeaderName'                    
      BEGIN                             
      select HeaderCMMID as ID,DBColumnName AS Name from UploadHeaderColumnMapping where UMID=@option1 AND FreezeStatus=0           
      END          
         
         
 ELSE IF @option = 'ControlBind'                    
      BEGIN                             
      select ControlID as ID,ControlName AS Name from WAT_ControlTypeMaster where ID NOT IN (1)      
      END         
       
    ELSE IF @option = 'BindAllDisPositionColumnName'                    
      BEGIN          
   DECLARE @WorkDMID VARCHAR(10)    
   DECLARE @WorkGMID VARCHAR(10)    
   DECLARE @DOCMID VARCHAR(10)    
    
   SELECT @WorkDMID= WorkDMID FROM WAT_WorkDivisionWorkItemDetail WHERE UMID=@option1    
      SELECT @WorkGMID= WorkGMID from WAT_WorkGroupWorkDivisionDetail WHERE WORKDMID=@WorkDMID    
      SELECT @DOCMID= DOCMID FROM dbo.WAT_DynamicOutcomeControlMaster WHERE workGMID=@WorkGMID    
      SELECT DBColumnName as ID,DBColumnName AS Name FROM dbo.WAT_DynamicOutcomeControlMasterDetail WHERE DOCMID=@DOCMID and controltype=0     
      END        
                   
        ELSE IF @option = 'WorkItemQueue'                    
      BEGIN          
   SELECT DISTINCT WM.WorkIMID AS ID,WM.WorkItemName AS [Name] from WAT_WorkItemMaster WM     
  JOIN WAT_WorkDivisionWorkItemDetail WDM ON WM.WorkIMID=WDM.WorkIMID    
  WHERE WM.FreezeStatus=0 AND WDM.FreezeStatus=0 AND ISNULL(UMID,0)>0    
  AND WM.ClientID=@option2    
      END                
    END;                    
 --select * from TPDomain                    
 --insert into TPDomain(domainname,domaindetail,freezestatus)                    
 --select 'N/A',null,0 